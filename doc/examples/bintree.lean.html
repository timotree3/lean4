<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" class="alectryon-standalone" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<title>Binary Search Trees</title>
<link rel="stylesheet" href="alectryon.css" type="text/css" />
<link rel="stylesheet" href="docutils_basic.css" type="text/css" />
<link rel="stylesheet" href="pygments.css" type="text/css" />
<script type="text/javascript" src="alectryon.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" />
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
<div class="alectryon-root alectryon-centered"><div class="alectryon-banner">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running Lean4 v4.0.0-unknown. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+â†‘</kbd> <kbd>Ctrl+â†“</kbd> to navigate, <kbd>Ctrl+ğŸ–±ï¸</kbd> to focus. On Mac, use <kbd>âŒ˜</kbd> instead of <kbd>Ctrl</kbd>.<br>Hover-Settings: Show types:<input id="toggleswitch" type="checkbox" onClick="toggleShowTypes(this);"> Show goals:<input id="toggleswitch" type="checkbox" onClick="toggleShowGoals(this);" checked><br></div><div class="document" id="binary-search-trees">
<h1 class="title">Binary Search Trees</h1>

<p>If the type of keys can be totally ordered -- that is, it supports a well-behaved <code class="highlight coq"><span class="o">â‰¤</span></code> comparison --
then maps can be implemented with binary search trees (BSTs). Insert and lookup operations on BSTs take time
proportional to the height of the tree. If the tree is balanced, the operations therefore take logarithmic time.</p>
<p>This example is based on a similar example found in the [&quot;Sofware Foundations&quot;](<a class="reference external" href="https://softwarefoundations.cis.upenn.edu/vfa-current/SearchTree.html">https://softwarefoundations.cis.upenn.edu/vfa-current/SearchTree.html</a>)
book (volume 3).</p>
<p>We use <code class="highlight coq"><span class="n">Nat</span></code> as the key type in our implementation of BSTs,
since it has a convenient total order with lots of theorems and automation available.
We leave as an exercise to the reader the generalization to arbitrary types.</p>
<pre class="alectryon-io type-info-hidden highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><div class="alectryon-token"><span class="kd">inductive</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Tree</var><b>: </b><span>Type v â†’ Type v</span></span></div></blockquote></div></small></div>Tree</div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Î²</var><b>: </b><span>Type v</span></span></div></blockquote></div></small></div><span class="nv">Î²</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Type v</var><b>: </b><span>Type (v + 1)</span></span></div></blockquote></div></small></div><span class="kt">Type</span> v</div><div class="alectryon-token">) </div><div class="alectryon-token"><span class="k">where</span></div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>leaf</var><b>: </b><span>{Î² : Type v} â†’ _root_.Tree Î²</span></span></div></blockquote></div></small></div>leaf</div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>node</var><b>: </b><span>{Î² : Type v} â†’ _root_.Tree Î² â†’ Nat â†’ Î² â†’ _root_.Tree Î² â†’ _root_.Tree Î²</span></span></div></blockquote></div></small></div>node</div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>left</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">left</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Tree</var><b>: </b><span>Type v â†’ Sort _tmp_ind_univ_param</span></span></div></blockquote></div></small></div><span class="nv">Tree</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Î²</var><b>: </b><span>Type v</span></span></div></blockquote></div></small></div><span class="nv">Î²</span></div><div class="alectryon-token">) (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>key</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">key</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Nat</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div>Nat</div><div class="alectryon-token">) (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>value</var><b>: </b><span>Î²</span></span></div></blockquote></div></small></div><span class="nv">value</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Î²</var><b>: </b><span>Type v</span></span></div></blockquote></div></small></div><span class="nv">Î²</span></div><div class="alectryon-token">) (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>right</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">right</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Tree</var><b>: </b><span>Type v â†’ Sort _tmp_ind_univ_param</span></span></div></blockquote></div></small></div><span class="nv">Tree</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Î²</var><b>: </b><span>Type v</span></span></div></blockquote></div></small></div><span class="nv">Î²</span></div><div class="alectryon-token">)
  </div><div class="alectryon-token"><span class="k">deriving</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Repr</var><b>: </b><span>Type u â†’ Type u</span></span></div></blockquote></div></small></div>Repr</div><div class="alectryon-token"></div></span></pre><p>The function <code class="highlight coq"><span class="n">contains</span></code> returns <code class="highlight coq"><span class="n">true</span></code> iff the given gree contains the key <code class="highlight coq"><span class="n">k</span></code>.</p>
<pre class="alectryon-io type-info-hidden highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><div class="alectryon-token"><span class="kd">def</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Tree.contains</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î² â†’ Nat â†’ Bool</span></span></div></blockquote></div></small></div>Tree.contains</div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">t</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Tree</var><b>: </b><span>Type u_1 â†’ Type u_1</span></span></div></blockquote></div></small></div>Tree</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Î²</var><b>: </b><span>Type u_1</span></span></div></blockquote></div></small></div><span class="nv">Î²</span></div><div class="alectryon-token">) (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Nat</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div>Nat</div><div class="alectryon-token">) : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Bool</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div>Bool</div><div class="alectryon-token"> :=
  </div><div class="alectryon-token"><span class="k">match</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">t</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><span class="k">with</span></div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>leaf</var><b>: </b><span>{Î² : Type ?u.1286} â†’ Tree Î²</span></span></div></blockquote></div></small></div>leaf</div><div class="alectryon-token"> <span class="bp">=&gt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>false</var><b>: </b><span>Bool</span></span></div></blockquote></div></small></div>false</div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>node</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î² â†’ Nat â†’ Î² â†’ Tree Î² â†’ Tree Î²</span></span></div></blockquote></div></small></div>node</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>left</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">left</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>key</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">key</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>value</var><b>: </b><span>Î²</span></span></div></blockquote></div></small></div><span class="nv">value</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>right</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">right</span></div><div class="alectryon-token"> <span class="bp">=&gt;</span>
    </div><div class="alectryon-token"><span class="k">if</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div><div class="alectryon-token"> <span class="bp">&lt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>key</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">key</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><span class="k">then</span></div><div class="alectryon-token">
      </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>left</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">left</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>contains</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î² â†’ Nat â†’ Bool</span></span></div></blockquote></div></small></div><span class="nv">contains</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div><div class="alectryon-token">
    </div><div class="alectryon-token"><span class="k">else</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><span class="k">if</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>key</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">key</span></div><div class="alectryon-token"> <span class="bp">&lt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><span class="k">then</span></div><div class="alectryon-token">
      </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>right</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">right</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>contains</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î² â†’ Nat â†’ Bool</span></span></div></blockquote></div></small></div><span class="nv">contains</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div><div class="alectryon-token">
    </div><div class="alectryon-token"><span class="k">else</span></div><div class="alectryon-token">
      </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>true</var><b>: </b><span>Bool</span></span></div></blockquote></div></small></div>true</div><div class="alectryon-token"></div></span></pre><p><code class="highlight coq"><span class="n">t</span><span class="o">.</span><span class="n">find</span><span class="o">?</span> <span class="n">k</span></code> returns <code class="highlight coq"><span class="n">some</span> <span class="n">v</span></code> if <code class="highlight coq"><span class="n">v</span></code> is the value bound to key <code class="highlight coq"><span class="n">k</span></code> in the tree <code class="highlight coq"><span class="n">t</span></code>. It returns <code class="highlight coq"><span class="n">none</span></code> otherwise.</p>
<pre class="alectryon-io type-info-hidden highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><div class="alectryon-token"><span class="kd">def</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Tree.find?</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î² â†’ Nat â†’ Option Î²</span></span></div></blockquote></div></small></div>Tree.find<span class="bp">?</span></div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">t</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Tree</var><b>: </b><span>Type u_1 â†’ Type u_1</span></span></div></blockquote></div></small></div>Tree</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Î²</var><b>: </b><span>Type u_1</span></span></div></blockquote></div></small></div><span class="nv">Î²</span></div><div class="alectryon-token">) (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Nat</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div>Nat</div><div class="alectryon-token">) : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Option</var><b>: </b><span>Type u_1 â†’ Type u_1</span></span></div></blockquote></div></small></div>Option</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Î²</var><b>: </b><span>Type u_1</span></span></div></blockquote></div></small></div><span class="nv">Î²</span></div><div class="alectryon-token"> :=
  </div><div class="alectryon-token"><span class="k">match</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">t</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><span class="k">with</span></div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>leaf</var><b>: </b><span>{Î² : Type ?u.1629} â†’ Tree Î²</span></span></div></blockquote></div></small></div>leaf</div><div class="alectryon-token"> <span class="bp">=&gt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>none</var><b>: </b><span>{Î± : Type u_1} â†’ Option Î±</span></span></div></blockquote></div></small></div>none</div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>node</var><b>: </b><span>{Î² : Type ?u.1641} â†’ Tree Î² â†’ Nat â†’ Î² â†’ Tree Î² â†’ Tree Î²</span></span></div></blockquote></div></small></div>node</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>left</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">left</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>key</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">key</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>value</var><b>: </b><span>Î²</span></span></div></blockquote></div></small></div><span class="nv">value</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>right</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">right</span></div><div class="alectryon-token"> <span class="bp">=&gt;</span>
    </div><div class="alectryon-token"><span class="k">if</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div><div class="alectryon-token"> <span class="bp">&lt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>key</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">key</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><span class="k">then</span></div><div class="alectryon-token">
      </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>left</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">left</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>find?</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î² â†’ Nat â†’ Option Î²</span></span></div></blockquote></div></small></div>find<span class="bp">?</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div><div class="alectryon-token">
    </div><div class="alectryon-token"><span class="k">else</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><span class="k">if</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>key</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">key</span></div><div class="alectryon-token"> <span class="bp">&lt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><span class="k">then</span></div><div class="alectryon-token">
      </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>right</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">right</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>find?</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î² â†’ Nat â†’ Option Î²</span></span></div></blockquote></div></small></div>find<span class="bp">?</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div><div class="alectryon-token">
    </div><div class="alectryon-token"><span class="k">else</span></div><div class="alectryon-token">
      </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>some</var><b>: </b><span>{Î± : Type u_1} â†’ Î± â†’ Option Î±</span></span></div></blockquote></div></small></div>some</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>value</var><b>: </b><span>Î²</span></span></div></blockquote></div></small></div><span class="nv">value</span></div><div class="alectryon-token"></div></span></pre><p><code class="highlight coq"><span class="n">t</span><span class="o">.</span><span class="n">insert</span> <span class="n">k</span> <span class="n">v</span></code> is the map containing all the bindings of <code class="highlight coq"><span class="n">t</span></code> along with a binding of <code class="highlight coq"><span class="n">k</span></code> to <code class="highlight coq"><span class="n">v</span></code>.</p>
<pre class="alectryon-io type-info-hidden highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><div class="alectryon-token"><span class="kd">def</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Tree.insert</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î² â†’ Nat â†’ Î² â†’ Tree Î²</span></span></div></blockquote></div></small></div>Tree.insert</div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">t</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Tree</var><b>: </b><span>Type u_1 â†’ Type u_1</span></span></div></blockquote></div></small></div>Tree</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Î²</var><b>: </b><span>Type u_1</span></span></div></blockquote></div></small></div><span class="nv">Î²</span></div><div class="alectryon-token">) (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Nat</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div>Nat</div><div class="alectryon-token">) (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>v</var><b>: </b><span>Î²</span></span></div></blockquote></div></small></div><span class="nv">v</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Î²</var><b>: </b><span>Type u_1</span></span></div></blockquote></div></small></div><span class="nv">Î²</span></div><div class="alectryon-token">) : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Tree</var><b>: </b><span>Type u_1 â†’ Type u_1</span></span></div></blockquote></div></small></div>Tree</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Î²</var><b>: </b><span>Type u_1</span></span></div></blockquote></div></small></div><span class="nv">Î²</span></div><div class="alectryon-token"> :=
  </div><div class="alectryon-token"><span class="k">match</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">t</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><span class="k">with</span></div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>leaf</var><b>: </b><span>{Î² : Type ?u.1981} â†’ Tree Î²</span></span></div></blockquote></div></small></div>leaf</div><div class="alectryon-token"> <span class="bp">=&gt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>node</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î² â†’ Nat â†’ Î² â†’ Tree Î² â†’ Tree Î²</span></span></div></blockquote></div></small></div>node</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>leaf</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î²</span></span></div></blockquote></div></small></div>leaf</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>v</var><b>: </b><span>Î²</span></span></div></blockquote></div></small></div><span class="nv">v</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>leaf</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î²</span></span></div></blockquote></div></small></div>leaf</div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>node</var><b>: </b><span>{Î² : Type ?u.1996} â†’ Tree Î² â†’ Nat â†’ Î² â†’ Tree Î² â†’ Tree Î²</span></span></div></blockquote></div></small></div>node</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>left</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">left</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>key</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">key</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>value</var><b>: </b><span>Î²</span></span></div></blockquote></div></small></div><span class="nv">value</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>right</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">right</span></div><div class="alectryon-token"> <span class="bp">=&gt;</span>
    </div><div class="alectryon-token"><span class="k">if</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div><div class="alectryon-token"> <span class="bp">&lt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>key</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">key</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><span class="k">then</span></div><div class="alectryon-token">
      </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>node</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î² â†’ Nat â†’ Î² â†’ Tree Î² â†’ Tree Î²</span></span></div></blockquote></div></small></div>node</div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>left</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">left</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>insert</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î² â†’ Nat â†’ Î² â†’ Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">insert</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>v</var><b>: </b><span>Î²</span></span></div></blockquote></div></small></div><span class="nv">v</span></div><div class="alectryon-token">) </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>key</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">key</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>value</var><b>: </b><span>Î²</span></span></div></blockquote></div></small></div><span class="nv">value</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>right</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">right</span></div><div class="alectryon-token">
    </div><div class="alectryon-token"><span class="k">else</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><span class="k">if</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>key</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">key</span></div><div class="alectryon-token"> <span class="bp">&lt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><span class="k">then</span></div><div class="alectryon-token">
      </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>node</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î² â†’ Nat â†’ Î² â†’ Tree Î² â†’ Tree Î²</span></span></div></blockquote></div></small></div>node</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>left</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">left</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>key</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">key</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>value</var><b>: </b><span>Î²</span></span></div></blockquote></div></small></div><span class="nv">value</span></div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>right</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">right</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>insert</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î² â†’ Nat â†’ Î² â†’ Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">insert</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>v</var><b>: </b><span>Î²</span></span></div></blockquote></div></small></div><span class="nv">v</span></div><div class="alectryon-token">)
    </div><div class="alectryon-token"><span class="k">else</span></div><div class="alectryon-token">
      </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>node</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î² â†’ Nat â†’ Î² â†’ Tree Î² â†’ Tree Î²</span></span></div></blockquote></div></small></div>node</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>left</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">left</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>v</var><b>: </b><span>Î²</span></span></div></blockquote></div></small></div><span class="nv">v</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>right</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">right</span></div><div class="alectryon-token"></div></span></pre><p>Let's add a new operation to our tree: converting it to an association list that contains the key--value bindings from the tree stored as pairs.
If that list is sorted by the keys, then any two trees that represent the same map would be converted to the same list.
Here's a function that does so with an in-order traversal of the tree.</p>
<pre class="alectryon-io type-info-hidden highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><div class="alectryon-token"><span class="kd">def</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Tree.toList</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î² â†’ List (Nat Ã— Î²)</span></span></div></blockquote></div></small></div>Tree.toList</div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">t</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Tree</var><b>: </b><span>Type u_1 â†’ Type u_1</span></span></div></blockquote></div></small></div>Tree</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Î²</var><b>: </b><span>Type u_1</span></span></div></blockquote></div></small></div><span class="nv">Î²</span></div><div class="alectryon-token">) : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>List</var><b>: </b><span>Type u_1 â†’ Type u_1</span></span></div></blockquote></div></small></div>List</div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Nat</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div>Nat</div><div class="alectryon-token"> <span class="bp">Ã—</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Î²</var><b>: </b><span>Type u_1</span></span></div></blockquote></div></small></div><span class="nv">Î²</span></div><div class="alectryon-token">) :=
  </div><div class="alectryon-token"><span class="k">match</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">t</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><span class="k">with</span></div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>leaf</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î²</span></span></div></blockquote></div></small></div>leaf</div><div class="alectryon-token"> <span class="bp">=&gt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>[]</var><b>: </b><span>List (Nat Ã— Î²)</span></span></div></blockquote></div></small></div>[]</div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>node</var><b>: </b><span>{Î² : Type ?u.2364} â†’ Tree Î² â†’ Nat â†’ Î² â†’ Tree Î² â†’ Tree Î²</span></span></div></blockquote></div></small></div>node</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>l</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">l</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>v</var><b>: </b><span>Î²</span></span></div></blockquote></div></small></div><span class="nv">v</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>r</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">r</span></div><div class="alectryon-token"> <span class="bp">=&gt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>l</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">l</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>toList</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î² â†’ List (Nat Ã— Î²)</span></span></div></blockquote></div></small></div><span class="nv">toList</span></div><div class="alectryon-token"> <span class="bp">++</span> [(</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div><div class="alectryon-token">, </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>v</var><b>: </b><span>Î²</span></span></div></blockquote></div></small></div><span class="nv">v</span></div><div class="alectryon-token">)] <span class="bp">++</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>r</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">r</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>toList</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î² â†’ List (Nat Ã— Î²)</span></span></div></blockquote></div></small></div><span class="nv">toList</span></div><div class="alectryon-token">

</div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk0"><div class="alectryon-token"><span class="k">#eval</span></div></label><small class="alectryon-output"><div><div class="alectryon-messages"><blockquote class="alectryon-message">Tree.node (Tree.node (Tree.leaf) <span class="mi">1</span> <span class="s2">&quot;one&quot;</span> (Tree.leaf)) <span class="mi">2</span> <span class="s2">&quot;two&quot;</span> (Tree.node (Tree.leaf) <span class="mi">3</span> <span class="s2">&quot;three&quot;</span> (Tree.leaf))
</blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Tree.leaf</var><b>: </b><span>{Î² : Type} â†’ Tree Î²</span></span></div></blockquote></div></small></div>Tree.leaf</div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>insert</var><b>: </b><span>{Î² : Type} â†’ Tree Î² â†’ Nat â†’ Î² â†’ Tree Î²</span></span></div></blockquote></div></small></div>insert</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>2</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="mi">2</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>&quot;two&quot;</var><b>: </b><span>String</span></span></div></blockquote></div></small></div><span class="s2">&quot;two&quot;</span></div><div class="alectryon-token">
      <span class="bp">|&gt;.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>insert</var><b>: </b><span>{Î² : Type} â†’ Tree Î² â†’ Nat â†’ Î² â†’ Tree Î²</span></span></div></blockquote></div></small></div>insert</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>3</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="mi">3</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>&quot;three&quot;</var><b>: </b><span>String</span></span></div></blockquote></div></small></div><span class="s2">&quot;three&quot;</span></div><div class="alectryon-token">
      <span class="bp">|&gt;.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>insert</var><b>: </b><span>{Î² : Type} â†’ Tree Î² â†’ Nat â†’ Î² â†’ Tree Î²</span></span></div></blockquote></div></small></div>insert</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>1</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="mi">1</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>&quot;one&quot;</var><b>: </b><span>String</span></span></div></blockquote></div></small></div><span class="s2">&quot;one&quot;</span></div><div class="alectryon-token">

</div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk1" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk1"><div class="alectryon-token"><span class="k">#eval</span></div></label><small class="alectryon-output"><div><div class="alectryon-messages"><blockquote class="alectryon-message">[(<span class="mi">1</span>, <span class="s2">&quot;one&quot;</span>), (<span class="mi">2</span>, <span class="s2">&quot;two&quot;</span>), (<span class="mi">3</span>, <span class="s2">&quot;three&quot;</span>)]
</blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Tree.leaf</var><b>: </b><span>{Î² : Type} â†’ Tree Î²</span></span></div></blockquote></div></small></div>Tree.leaf</div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>insert</var><b>: </b><span>{Î² : Type} â†’ Tree Î² â†’ Nat â†’ Î² â†’ Tree Î²</span></span></div></blockquote></div></small></div>insert</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>2</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="mi">2</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>&quot;two&quot;</var><b>: </b><span>String</span></span></div></blockquote></div></small></div><span class="s2">&quot;two&quot;</span></div><div class="alectryon-token">
      <span class="bp">|&gt;.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>insert</var><b>: </b><span>{Î² : Type} â†’ Tree Î² â†’ Nat â†’ Î² â†’ Tree Î²</span></span></div></blockquote></div></small></div>insert</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>3</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="mi">3</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>&quot;three&quot;</var><b>: </b><span>String</span></span></div></blockquote></div></small></div><span class="s2">&quot;three&quot;</span></div><div class="alectryon-token">
      <span class="bp">|&gt;.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>insert</var><b>: </b><span>{Î² : Type} â†’ Tree Î² â†’ Nat â†’ Î² â†’ Tree Î²</span></span></div></blockquote></div></small></div>insert</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>1</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="mi">1</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>&quot;one&quot;</var><b>: </b><span>String</span></span></div></blockquote></div></small></div><span class="s2">&quot;one&quot;</span></div><div class="alectryon-token">
      <span class="bp">|&gt;.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>toList</var><b>: </b><span>{Î² : Type} â†’ Tree Î² â†’ List (Nat Ã— Î²)</span></span></div></blockquote></div></small></div>toList</div><div class="alectryon-token"></div></span></pre><p>The implemention of <code class="highlight coq"><span class="n">Tree</span><span class="o">.</span><span class="n">toList</span></code> is inefficient because of how it uses the <code class="highlight coq"><span class="o">++</span></code> operator.
On a balanced tree its running time is linearithmic, because it does a linear number of
concatentations at each level of the tree. On an unbalanced tree it's quadratic time.
Here's a tail-recursive implementation than runs in linear time, regardless of whether the tree is balanced:</p>
<pre class="alectryon-io type-info-hidden highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><div class="alectryon-token"><span class="kd">def</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Tree.toListTR</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î² â†’ List (Nat Ã— Î²)</span></span></div></blockquote></div></small></div>Tree.toListTR</div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">t</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Tree</var><b>: </b><span>Type u_1 â†’ Type u_1</span></span></div></blockquote></div></small></div>Tree</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Î²</var><b>: </b><span>Type u_1</span></span></div></blockquote></div></small></div><span class="nv">Î²</span></div><div class="alectryon-token">) : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>List</var><b>: </b><span>Type u_1 â†’ Type u_1</span></span></div></blockquote></div></small></div>List</div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Nat</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div>Nat</div><div class="alectryon-token"> <span class="bp">Ã—</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Î²</var><b>: </b><span>Type u_1</span></span></div></blockquote></div></small></div><span class="nv">Î²</span></div><div class="alectryon-token">) :=
  </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>go</var><b>: </b><span>Tree Î² â†’ List (Nat Ã— Î²) â†’ List (Nat Ã— Î²)</span></span></div></blockquote></div></small></div><span class="nv">go</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">t</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>[]</var><b>: </b><span>List (Nat Ã— Î²)</span></span></div></blockquote></div></small></div>[]</div><div class="alectryon-token">
</div><div class="alectryon-token"><span class="k">where</span></div><div class="alectryon-token">
  </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>go</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î² â†’ List (Nat Ã— Î²) â†’ List (Nat Ã— Î²)</span></span></div></blockquote></div></small></div><span class="nv">go</span></div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">t</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Tree</var><b>: </b><span>Type u_1 â†’ Type u_1</span></span></div></blockquote></div></small></div>Tree</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Î²</var><b>: </b><span>Type u_1</span></span></div></blockquote></div></small></div><span class="nv">Î²</span></div><div class="alectryon-token">) (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>acc</var><b>: </b><span>List (Nat Ã— Î²)</span></span></div></blockquote></div></small></div><span class="nv">acc</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>List</var><b>: </b><span>Type u_1 â†’ Type u_1</span></span></div></blockquote></div></small></div>List</div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Nat</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div>Nat</div><div class="alectryon-token"> <span class="bp">Ã—</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Î²</var><b>: </b><span>Type u_1</span></span></div></blockquote></div></small></div><span class="nv">Î²</span></div><div class="alectryon-token">)) : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>List</var><b>: </b><span>Type u_1 â†’ Type u_1</span></span></div></blockquote></div></small></div>List</div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Nat</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div>Nat</div><div class="alectryon-token"> <span class="bp">Ã—</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Î²</var><b>: </b><span>Type u_1</span></span></div></blockquote></div></small></div><span class="nv">Î²</span></div><div class="alectryon-token">) :=
    </div><div class="alectryon-token"><span class="k">match</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">t</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><span class="k">with</span></div><div class="alectryon-token">
    <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>leaf</var><b>: </b><span>{Î² : Type ?u.2853} â†’ Tree Î²</span></span></div></blockquote></div></small></div>leaf</div><div class="alectryon-token"> <span class="bp">=&gt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>acc</var><b>: </b><span>List (Nat Ã— Î²)</span></span></div></blockquote></div></small></div><span class="nv">acc</span></div><div class="alectryon-token">
    <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>node</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î² â†’ Nat â†’ Î² â†’ Tree Î² â†’ Tree Î²</span></span></div></blockquote></div></small></div>node</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>l</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">l</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>v</var><b>: </b><span>Î²</span></span></div></blockquote></div></small></div><span class="nv">v</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>r</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">r</span></div><div class="alectryon-token"> <span class="bp">=&gt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>l</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">l</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>go</var><b>: </b><span>Tree Î² â†’ List (Nat Ã— Î²) â†’ List (Nat Ã— Î²)</span></span></div></blockquote></div></small></div><span class="nv">go</span></div><div class="alectryon-token"> ((</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div><div class="alectryon-token">, </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>v</var><b>: </b><span>Î²</span></span></div></blockquote></div></small></div><span class="nv">v</span></div><div class="alectryon-token">) :: </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>r</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">r</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>go</var><b>: </b><span>Tree Î² â†’ List (Nat Ã— Î²) â†’ List (Nat Ã— Î²)</span></span></div></blockquote></div></small></div><span class="nv">go</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>acc</var><b>: </b><span>List (Nat Ã— Î²)</span></span></div></blockquote></div></small></div><span class="nv">acc</span></div><div class="alectryon-token">)</div></span></pre><p>We now prove that <code class="highlight coq"><span class="n">t</span><span class="o">.</span><span class="n">toList</span></code> and <code class="highlight coq"><span class="n">t</span><span class="o">.</span><span class="n">toListTR</span></code> return the same list.
The proof is on induction, and as we used the auxiliary function <code class="highlight coq"><span class="n">go</span></code>
to define <code class="highlight coq"><span class="n">Tree</span><span class="o">.</span><span class="n">toListTR</span></code>, we use the auxiliary theorem <code class="highlight coq"><span class="n">go</span></code> to prove the theorem.</p>
<p>The proof of the auxiliary theorem is by induction on <code class="highlight coq"><span class="n">t</span></code>.
The <code class="highlight coq"><span class="nb">generalizing</span> <span class="n">acc</span></code> modifier instructs Lean to revert <code class="highlight coq"><span class="n">acc</span></code>, apply the
induction theorem for <code class="highlight coq"><span class="n">Tree</span></code>s, and then reintroduce <code class="highlight coq"><span class="n">acc</span></code> in each case.
By using <code class="highlight coq"><span class="nb">generalizing</span></code>, we obtain the more general induction hypotheses</p>
<ul class="simple">
<li><code class="highlight coq"><span class="n">left_ih</span> <span class="o">:</span> <span class="kr">âˆ€</span> <span class="nv">acc</span><span class="o">,</span> <span class="n">toListTR</span><span class="o">.</span><span class="n">go</span> <span class="nb">left</span> <span class="n">acc</span> <span class="o">=</span> <span class="n">toList</span> <span class="nb">left</span> <span class="o">++</span> <span class="n">acc</span></code></li>
<li><code class="highlight coq"><span class="n">right_ih</span> <span class="o">:</span> <span class="kr">âˆ€</span> <span class="nv">acc</span><span class="o">,</span> <span class="n">toListTR</span><span class="o">.</span><span class="n">go</span> <span class="nb">right</span> <span class="n">acc</span> <span class="o">=</span> <span class="n">toList</span> <span class="nb">right</span> <span class="o">++</span> <span class="n">acc</span></code></li>
</ul>
<p>Recall that the combinator <code class="highlight coq"><span class="n">tac</span> <span class="o">&lt;;&gt;</span> <span class="n">tac'</span></code> runs <code class="highlight coq"><span class="n">tac</span></code> on the main goal and <code class="highlight coq"><span class="n">tac'</span></code> on each produced goal,
concatenating all goals produced by <code class="highlight coq"><span class="n">tac'</span></code>. In this theorem, we use it to apply
<code class="highlight coq"><span class="n">simp</span></code> and close each subgoal produced by the <code class="highlight coq"><span class="nb">induction</span></code> tactic.</p>
<p>The <code class="highlight coq"><span class="n">simp</span></code> parameters <code class="highlight coq"><span class="n">toListTR</span><span class="o">.</span><span class="n">go</span></code> and <code class="highlight coq"><span class="n">toList</span></code> instruct the simplifier to try to reduce
and/or apply auto generated equation theorems for these two functions.
The parameter <code class="highlight coq"><span class="o">*</span></code> intructs the simplifier to use any equation in a goal as rewriting rules.
In this particular case, <code class="highlight coq"><span class="n">simp</span></code> uses the induction hypotheses as rewriting rules.
Finally, the parameter <code class="highlight coq"><span class="n">List</span><span class="o">.</span><span class="n">append_assoc</span></code> intructs the simplifier to use the
<code class="highlight coq"><span class="n">List</span><span class="o">.</span><span class="n">append_assoc</span></code> theorem as a rewriting rule.</p>
<pre class="alectryon-io type-info-hidden highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><div class="alectryon-token"><span class="kd">theorem</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Tree.toList_eq_toListTR</var><b>: </b><span>âˆ€ {Î² : Type u_1} (t : Tree Î²), toList t = toListTR t</span></span></div></blockquote></div></small></div>Tree.toList_eq_toListTR</div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">t</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Tree</var><b>: </b><span>Type u_1 â†’ Type u_1</span></span></div></blockquote></div></small></div>Tree</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Î²</var><b>: </b><span>Type u_1</span></span></div></blockquote></div></small></div><span class="nv">Î²</span></div><div class="alectryon-token">)
        : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">t</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>toList</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î² â†’ List (Nat Ã— Î²)</span></span></div></blockquote></div></small></div>toList</div><div class="alectryon-token"> <span class="bp">=</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">t</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>toListTR</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î² â†’ List (Nat Ã— Î²)</span></span></div></blockquote></div></small></div>toListTR</div><div class="alectryon-token"> := </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk2" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk2"><div class="alectryon-token"><span class="kd">by</span></div><div class="alectryon-token"></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">toList t <span class="bp">=</span> toListTR t</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
  </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk3" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk3"><div class="alectryon-token"><span class="k">simp</span></div><div class="alectryon-token"> [</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>toListTR</var><b>: </b><span>{Î² : Type ?u.4231} â†’ Tree Î² â†’ List (Nat Ã— Î²)</span></span></div></blockquote></div></small></div>toListTR</div><div class="alectryon-token">, </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>go</var><b>: </b><span>âˆ€ (t : Tree Î²) (acc : List (Nat Ã— Î²)), toListTR.go t acc = toList t ++ acc</span></span></div></blockquote></div></small></div><span class="nv">go</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">t</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>[]</var><b>: </b><span>List (Nat Ã— Î²)</span></span></div></blockquote></div></small></div>[]</div><div class="alectryon-token">]</div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Goals accomplished<span class="bp">!</span> <span class="bp">ğŸ™</span></div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
</div><div class="alectryon-token"><span class="k">where</span></div><div class="alectryon-token">
  </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>go</var><b>: </b><span>âˆ€ {Î² : Type u_1} (t : Tree Î²) (acc : List (Nat Ã— Î²)), toListTR.go t acc = toList t ++ acc</span></span></div></blockquote></div></small></div><span class="nv">go</span></div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">t</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Tree</var><b>: </b><span>Type u_1 â†’ Type u_1</span></span></div></blockquote></div></small></div>Tree</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Î²</var><b>: </b><span>Type u_1</span></span></div></blockquote></div></small></div><span class="nv">Î²</span></div><div class="alectryon-token">) (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>acc</var><b>: </b><span>List (Nat Ã— Î²)</span></span></div></blockquote></div></small></div><span class="nv">acc</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>List</var><b>: </b><span>Type u_1 â†’ Type u_1</span></span></div></blockquote></div></small></div>List</div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Nat</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div>Nat</div><div class="alectryon-token"> <span class="bp">Ã—</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Î²</var><b>: </b><span>Type u_1</span></span></div></blockquote></div></small></div><span class="nv">Î²</span></div><div class="alectryon-token">))
     : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>toListTR.go</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î² â†’ List (Nat Ã— Î²) â†’ List (Nat Ã— Î²)</span></span></div></blockquote></div></small></div>toListTR.go</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">t</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>acc</var><b>: </b><span>List (Nat Ã— Î²)</span></span></div></blockquote></div></small></div><span class="nv">acc</span></div><div class="alectryon-token"> <span class="bp">=</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">t</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>toList</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î² â†’ List (Nat Ã— Î²)</span></span></div></blockquote></div></small></div>toList</div><div class="alectryon-token"> <span class="bp">++</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>acc</var><b>: </b><span>List (Nat Ã— Î²)</span></span></div></blockquote></div></small></div><span class="nv">acc</span></div><div class="alectryon-token"> := </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk4" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk4"><div class="alectryon-token"><span class="kd">by</span></div><div class="alectryon-token"></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>tâœ, t</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>acc</var><span class="hyp-type"><b>: </b><span>List (Nat <span class="bp">Ã—</span> Î²)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">toListTR.go t acc <span class="bp">=</span> toList t <span class="bp">++</span> acc</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
    </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk5" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk5"><div class="alectryon-token"><span class="k">induction</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">t</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><span class="k">generalizing</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>acc</var><b>: </b><span>List (Nat Ã— Î²)</span></span></div></blockquote></div></small></div><span class="nv">acc</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>acc</var><span class="hyp-type"><b>: </b><span>List (Nat <span class="bp">Ã—</span> Î²)</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">leaf</span></span><div class="goal-conclusion">toListTR.go leaf acc <span class="bp">=</span> toList leaf <span class="bp">++</span> acc</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>t, leftâœ</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>keyâœ</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>valueâœ</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>rightâœ</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>acc</var><span class="hyp-type"><b>: </b><span>List (Nat <span class="bp">Ã—</span> Î²)</span></span></span><br></div><label class="goal-separator" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk6"><hr><span class="goal-name">node</span></label><div class="goal-conclusion">toListTR.go (node left<span class="bp">âœ</span> key<span class="bp">âœ</span> value<span class="bp">âœ</span> right<span class="bp">âœ</span>) acc <span class="bp">=</span> toList (node left<span class="bp">âœ</span> key<span class="bp">âœ</span> value<span class="bp">âœ</span> right<span class="bp">âœ</span>) <span class="bp">++</span> acc</div></blockquote></div></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"> </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk7" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk7"><div class="alectryon-token"><span class="k">&lt;;&gt;</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>tâœ, t</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>acc</var><span class="hyp-type"><b>: </b><span>List (Nat <span class="bp">Ã—</span> Î²)</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">toListTR.go t acc <span class="bp">=</span> toList t <span class="bp">++</span> acc</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
      </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk8" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk8"><div class="alectryon-token"><span class="k">simp</span></div><div class="alectryon-token"> [</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>toListTR.go</var><b>: </b><span>{Î² : Type ?u.3313} â†’ Tree Î² â†’ List (Nat Ã— Î²) â†’ List (Nat Ã— Î²)</span></span></div></blockquote></div></small></div><span class="k">toListTR.go</span></div><div class="alectryon-token">, </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>toList</var><b>: </b><span>{Î² : Type ?u.4049} â†’ Tree Î² â†’ List (Nat Ã— Î²)</span></span></div></blockquote></div></small></div><span class="k">toList</span></div><div class="alectryon-token">, <span class="bp">*</span>, </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>List.append_assoc</var><b>: </b><span>âˆ€ {Î± : Type ?u.4062} (as bs cs : List Î±), as ++ bs ++ cs = as ++ (bs ++ cs)</span></span></div></blockquote></div></small></div><span class="k">List.append_assoc</span></div><div class="alectryon-token">]</div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Goals accomplished<span class="bp">!</span> <span class="bp">ğŸ™</span></div></blockquote></div></div></small></span></pre><p>The <code class="highlight coq"><span class="o">[</span><span class="n">csimp</span><span class="o">]</span></code> annotation instructs the Lean code generator to replace
any <code class="highlight coq"><span class="n">Tree</span><span class="o">.</span><span class="n">toList</span></code> with <code class="highlight coq"><span class="n">Tree</span><span class="o">.</span><span class="n">toListTR</span></code> when generating code.</p>
<pre class="alectryon-io type-info-hidden highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><div class="alectryon-token"><span class="kd">@[csimp]</span> </div><div class="alectryon-token"><span class="kd">theorem</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Tree.toList_eq_toListTR_csimp</var><b>: </b><span>@toList = @toListTR</span></span></div></blockquote></div></small></div>Tree.toList_eq_toListTR_csimp</div><div class="alectryon-token">
                 : <span class="bp">@</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Tree.toList</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î² â†’ List (Nat Ã— Î²)</span></span></div></blockquote></div></small></div>Tree.toList</div><div class="alectryon-token"> <span class="bp">=</span> <span class="bp">@</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Tree.toListTR</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î² â†’ List (Nat Ã— Î²)</span></span></div></blockquote></div></small></div>Tree.toListTR</div><div class="alectryon-token"> := </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk9" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk9"><div class="alectryon-token"><span class="kd">by</span></div><div class="alectryon-token"></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="bp">@</span>toList <span class="bp">=</span> <span class="bp">@</span>toListTR</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
  </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chka" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chka"><div class="alectryon-token"><span class="k">funext</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Î²</var><b>: </b><span>Type u_1</span></span></div></blockquote></div></small></div><span class="nv">Î²</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">t</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">h.h</span></span><div class="goal-conclusion">toList t <span class="bp">=</span> toListTR t</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
  </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chkb" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chkb"><div class="alectryon-token"><span class="k">apply</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>toList_eq_toListTR</var><b>: </b><span>âˆ€ {Î² : Type u_1} (t : Tree Î²), toList t = toListTR t</span></span></div></blockquote></div></small></div>toList_eq_toListTR</div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Goals accomplished<span class="bp">!</span> <span class="bp">ğŸ™</span></div></blockquote></div></div></small></span></pre><p>The implementations of <code class="highlight coq"><span class="n">Tree</span><span class="o">.</span><span class="n">find</span><span class="o">?</span></code> and <code class="highlight coq"><span class="n">Tree</span><span class="o">.</span><span class="n">insert</span></code> assume that values of type tree obey the BST invariant:
for any non-empty node with key <code class="highlight coq"><span class="n">k</span></code>, all the values of the <code class="highlight coq"><span class="nb">left</span></code> subtree are less than <code class="highlight coq"><span class="n">k</span></code> and all the values
of the right subtree are greater than <code class="highlight coq"><span class="n">k</span></code>. But that invariant is not part of the definition of tree.</p>
<p>So, let's formalize the BST invariant. Here's one way to do so. First, we define a helper <code class="highlight coq"><span class="n">ForallTree</span></code>
to express that idea that a predicate holds at every node of a tree:</p>
<pre class="alectryon-io type-info-hidden highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><div class="alectryon-token"><span class="kd">inductive</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ForallTree</var><b>: </b><span>{Î² : Type u_1} â†’ (Nat â†’ Î² â†’ Prop) â†’ Tree Î² â†’ Prop</span></span></div></blockquote></div></small></div>ForallTree</div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>p</var><b>: </b><span>Nat â†’ Î² â†’ Prop</span></span></div></blockquote></div></small></div><span class="nv">p</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Nat</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div>Nat</div><div class="alectryon-token"> <span class="bp">â†’</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Î²</var><b>: </b><span>Type u_1</span></span></div></blockquote></div></small></div><span class="nv">Î²</span></div><div class="alectryon-token"> <span class="bp">â†’</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Prop</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div><span class="kt">Prop</span></div><div class="alectryon-token">) : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Tree</var><b>: </b><span>Type u_1 â†’ Type u_1</span></span></div></blockquote></div></small></div>Tree</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Î²</var><b>: </b><span>Type u_1</span></span></div></blockquote></div></small></div><span class="nv">Î²</span></div><div class="alectryon-token"> <span class="bp">â†’</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Prop</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div><span class="kt">Prop</span></div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>leaf</var><b>: </b><span>âˆ€ {Î² : Type u_1} {p : Nat â†’ Î² â†’ Prop}, _root_.ForallTree p Tree.leaf</span></span></div></blockquote></div></small></div>leaf</div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ForallTree</var><b>: </b><span>{Î² : Type u_1} â†’ (Nat â†’ Î² â†’ Prop) â†’ Tree Î² â†’ Prop</span></span></div></blockquote></div></small></div><span class="nv">ForallTree</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>p</var><b>: </b><span>Nat â†’ Î² â†’ Prop</span></span></div></blockquote></div></small></div><span class="nv">p</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.leaf</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î²</span></span></div></blockquote></div></small></div><span class="bp">.</span>leaf</div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>node</var><b>: </b><span>âˆ€ {Î² : Type u_1} {p : Nat â†’ Î² â†’ Prop} {left : Tree Î²} {key : Nat} {value : Î²} {right : Tree Î²},
  _root_.ForallTree p left â†’
    p key value â†’ _root_.ForallTree p right â†’ _root_.ForallTree p (Tree.node left key value right)</span></span></div></blockquote></div></small></div>node</div><div class="alectryon-token"> :
     </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ForallTree</var><b>: </b><span>{Î² : Type u_1} â†’ (Nat â†’ Î² â†’ Prop) â†’ Tree Î² â†’ Prop</span></span></div></blockquote></div></small></div><span class="nv">ForallTree</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>p</var><b>: </b><span>Nat â†’ Î² â†’ Prop</span></span></div></blockquote></div></small></div><span class="nv">p</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>left</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">left</span></div><div class="alectryon-token"> <span class="bp">â†’</span>
     </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>p</var><b>: </b><span>Nat â†’ Î² â†’ Prop</span></span></div></blockquote></div></small></div><span class="nv">p</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>key</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">key</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>value</var><b>: </b><span>Î²</span></span></div></blockquote></div></small></div><span class="nv">value</span></div><div class="alectryon-token"> <span class="bp">â†’</span>
     </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ForallTree</var><b>: </b><span>{Î² : Type u_1} â†’ (Nat â†’ Î² â†’ Prop) â†’ Tree Î² â†’ Prop</span></span></div></blockquote></div></small></div><span class="nv">ForallTree</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>p</var><b>: </b><span>Nat â†’ Î² â†’ Prop</span></span></div></blockquote></div></small></div><span class="nv">p</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>right</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">right</span></div><div class="alectryon-token"> <span class="bp">â†’</span>
     </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ForallTree</var><b>: </b><span>{Î² : Type u_1} â†’ (Nat â†’ Î² â†’ Prop) â†’ Tree Î² â†’ Prop</span></span></div></blockquote></div></small></div><span class="nv">ForallTree</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>p</var><b>: </b><span>Nat â†’ Î² â†’ Prop</span></span></div></blockquote></div></small></div><span class="nv">p</span></div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.node</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î² â†’ Nat â†’ Î² â†’ Tree Î² â†’ Tree Î²</span></span></div></blockquote></div></small></div><span class="bp">.</span>node</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>left</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">left</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>key</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">key</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>value</var><b>: </b><span>Î²</span></span></div></blockquote></div></small></div><span class="nv">value</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>right</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">right</span></div><div class="alectryon-token">)</div></span></pre><p>Second, we define the BST invariant:
An empty tree is a BST.
A non-empty tree is a BST if all its left nodes have a lesser key, its right nodes have a greater key, and the left and right subtrees are themselves BSTs.</p>
<pre class="alectryon-io type-info-hidden highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><div class="alectryon-token"><span class="kd">inductive</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>BST</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î² â†’ Prop</span></span></div></blockquote></div></small></div>BST</div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Tree</var><b>: </b><span>Type u_1 â†’ Type u_1</span></span></div></blockquote></div></small></div>Tree</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Î²</var><b>: </b><span>Type u_1</span></span></div></blockquote></div></small></div><span class="nv">Î²</span></div><div class="alectryon-token"> <span class="bp">â†’</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Prop</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div><span class="kt">Prop</span></div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>leaf</var><b>: </b><span>âˆ€ {Î² : Type u_1}, _root_.BST Tree.leaf</span></span></div></blockquote></div></small></div>leaf</div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>BST</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î² â†’ Prop</span></span></div></blockquote></div></small></div><span class="nv">BST</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.leaf</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î²</span></span></div></blockquote></div></small></div><span class="bp">.</span>leaf</div><div class="alectryon-token">
  <span class="bp">|</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>node</var><b>: </b><span>âˆ€ {Î² : Type u_1} {key : Nat} {left right : Tree Î²} {value : Î²},
  ForallTree (fun k v =&gt; k &lt; key) left â†’
    ForallTree (fun k v =&gt; key &lt; k) right â†’
      _root_.BST left â†’ _root_.BST right â†’ _root_.BST (Tree.node left key value right)</span></span></div></blockquote></div></small></div>node</div><div class="alectryon-token"> :
     </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ForallTree</var><b>: </b><span>{Î² : Type u_1} â†’ (Nat â†’ Î² â†’ Prop) â†’ Tree Î² â†’ Prop</span></span></div></blockquote></div></small></div>ForallTree</div><div class="alectryon-token"> (</div><div class="alectryon-token"><span class="k">fun</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>v</var><b>: </b><span>?m.5033</span></span></div></blockquote></div></small></div><span class="nv">v</span></div><div class="alectryon-token"> <span class="bp">=&gt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div><div class="alectryon-token"> <span class="bp">&lt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>key</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">key</span></div><div class="alectryon-token">) </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>left</var><b>: </b><span>Tree ?m.5033</span></span></div></blockquote></div></small></div><span class="nv">left</span></div><div class="alectryon-token"> <span class="bp">â†’</span>
     </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ForallTree</var><b>: </b><span>{Î² : Type u_1} â†’ (Nat â†’ Î² â†’ Prop) â†’ Tree Î² â†’ Prop</span></span></div></blockquote></div></small></div>ForallTree</div><div class="alectryon-token"> (</div><div class="alectryon-token"><span class="k">fun</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>v</var><b>: </b><span>?m.5033</span></span></div></blockquote></div></small></div><span class="nv">v</span></div><div class="alectryon-token"> <span class="bp">=&gt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>key</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">key</span></div><div class="alectryon-token"> <span class="bp">&lt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div><div class="alectryon-token">) </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>right</var><b>: </b><span>Tree ?m.5033</span></span></div></blockquote></div></small></div><span class="nv">right</span></div><div class="alectryon-token"> <span class="bp">â†’</span>
     </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>BST</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î² â†’ Prop</span></span></div></blockquote></div></small></div><span class="nv">BST</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>left</var><b>: </b><span>Tree ?m.5033</span></span></div></blockquote></div></small></div><span class="nv">left</span></div><div class="alectryon-token"> <span class="bp">â†’</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>BST</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î² â†’ Prop</span></span></div></blockquote></div></small></div><span class="nv">BST</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>right</var><b>: </b><span>Tree ?m.5033</span></span></div></blockquote></div></small></div><span class="nv">right</span></div><div class="alectryon-token"> <span class="bp">â†’</span>
     </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>BST</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î² â†’ Prop</span></span></div></blockquote></div></small></div><span class="nv">BST</span></div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.node</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î² â†’ Nat â†’ Î² â†’ Tree Î² â†’ Tree Î²</span></span></div></blockquote></div></small></div><span class="bp">.</span>node</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>left</var><b>: </b><span>Tree ?m.5033</span></span></div></blockquote></div></small></div><span class="nv">left</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>key</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">key</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>value</var><b>: </b><span>?m.5033</span></span></div></blockquote></div></small></div><span class="nv">value</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>right</var><b>: </b><span>Tree ?m.5033</span></span></div></blockquote></div></small></div><span class="nv">right</span></div><div class="alectryon-token">)</div></span></pre><p>We can use the <code class="highlight coq"><span class="n">macro</span></code> command to create helper tactics for organizing our proofs.
The macro <code class="highlight coq"><span class="n">have_eq</span> <span class="n">x</span> <span class="n">y</span></code> tries to prove <code class="highlight coq"><span class="n">x</span> <span class="o">=</span> <span class="n">y</span></code> using linear arithmetic, and then
immediately uses the new equality to substitute <code class="highlight coq"><span class="n">x</span></code> with <code class="highlight coq"><span class="n">y</span></code> everywhere in the goal.</p>
<p>The modifier <code class="highlight coq"><span class="n">local</span></code> specifies the scope of the macro.</p>
<pre class="alectryon-io type-info-hidden highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><div class="alectryon-token"><span class="kn">local</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><span class="k">macro</span></div><div class="alectryon-token"> <span class="s2">&quot;have_eq &quot;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>lhs</var><b>: </b><span>Lean.Syntax</span></span></div></blockquote></div></small></div><span class="nv">lhs</span></div><div class="alectryon-token">:term:</div><div class="alectryon-token"><span class="k">max</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>rhs</var><b>: </b><span>Lean.Syntax</span></span></div></blockquote></div></small></div><span class="nv">rhs</span></div><div class="alectryon-token">:term:</div><div class="alectryon-token"><span class="k">max</span></div><div class="alectryon-token"> : tactic <span class="bp">=&gt;</span>
  <span class="bp">`</span>((</div><div class="alectryon-token"><span class="k">have</span></div><div class="alectryon-token"> h : <span class="bp">$</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>lhs</var><b>: </b><span>Lean.Syntax</span></span></div></blockquote></div></small></div><span class="nv">lhs</span></div><div class="alectryon-token">:term <span class="bp">=</span> <span class="bp">$</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>rhs</var><b>: </b><span>Lean.Syntax</span></span></div></blockquote></div></small></div><span class="nv">rhs</span></div><div class="alectryon-token">:term :=
       <span class="c1">-- TODO: replace with linarith</span>
       </div><div class="alectryon-token"><span class="kd">by</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><span class="k">simp_arith</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><span class="k">at</span></div><div class="alectryon-token"> <span class="bp">*;</span> </div><div class="alectryon-token"><span class="k">apply</span></div><div class="alectryon-token"> Nat.le_antisymm <span class="bp">&lt;;&gt;</span> </div><div class="alectryon-token"><span class="k">assumption</span></div><div class="alectryon-token">
     </div><div class="alectryon-token"><span class="k">try</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><span class="k">subst</span></div><div class="alectryon-token"> <span class="bp">$</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>lhs</var><b>: </b><span>Lean.Syntax</span></span></div></blockquote></div></small></div><span class="nv">lhs</span></div><div class="alectryon-token">:term))</div><div class="alectryon-token"></div></span></pre><p>The <code class="highlight coq"><span class="n">by_cases'</span> <span class="n">e</span></code> is just the regular <code class="highlight coq"><span class="n">by_cases</span></code> followed by <code class="highlight coq"><span class="n">simp</span></code> using all
hypotheses in the current goal as rewriting rules.
Recall that the <code class="highlight coq"><span class="n">by_cases</span></code> tactic creates two goals. One where we have <code class="highlight coq"><span class="n">h</span> <span class="o">:</span> <span class="n">e</span></code> and
another one containing <code class="highlight coq"><span class="n">h</span> <span class="o">:</span> <span class="o">Â¬</span> <span class="n">e</span></code>. The simplier uses the <code class="highlight coq"><span class="n">h</span></code> to rewrite <code class="highlight coq"><span class="n">e</span></code> to <code class="highlight coq"><span class="kt">True</span></code>
in the first subgoal, and <code class="highlight coq"><span class="n">e</span></code> to <code class="highlight coq"><span class="kt">False</span></code> in the second. This is particularly
useful if <code class="highlight coq"><span class="n">e</span></code> is the condition of an <code class="highlight coq"><span class="kr">if</span></code>-statement.</p>
<pre class="alectryon-io type-info-hidden highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><div class="alectryon-token"><span class="kn">local</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><span class="k">macro</span></div><div class="alectryon-token"> <span class="s2">&quot;by_cases&#39; &quot;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>e</var><b>: </b><span>Lean.Syntax</span></span></div></blockquote></div></small></div><span class="nv">e</span></div><div class="alectryon-token">:term :  tactic <span class="bp">=&gt;</span>
  <span class="bp">`</span>(</div><div class="alectryon-token"><span class="k">by_cases</span></div><div class="alectryon-token"> <span class="bp">$</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>e</var><b>: </b><span>Lean.Syntax</span></span></div></blockquote></div></small></div><span class="nv">e</span></div><div class="alectryon-token">:term <span class="bp">&lt;;&gt;</span> </div><div class="alectryon-token"><span class="k">simp</span></div><div class="alectryon-token"> [<span class="bp">*</span>])</div><div class="alectryon-token"></div></span></pre><p>We can use the attribute <code class="highlight coq"><span class="o">[</span><span class="n">simp</span><span class="o">]</span></code> to instruct the simplifier to reduce given definitions or
apply rewrite theorems. The <code class="highlight coq"><span class="n">local</span></code> modifier limits the scope of this modification to this file.</p>
<pre class="alectryon-io type-info-hidden highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><div class="alectryon-token"><span class="kn">attribute</span></div><div class="alectryon-token"> [</div><div class="alectryon-token"><span class="kn">local</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><span class="k">simp</span></div><div class="alectryon-token">] </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Tree.insert</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î² â†’ Nat â†’ Î² â†’ Tree Î²</span></span></div></blockquote></div></small></div>Tree.insert</div><div class="alectryon-token"></div></span></pre><p>We now prove that <code class="highlight coq"><span class="n">Tree</span><span class="o">.</span><span class="n">insert</span></code> preserves the BST invariant using induction and case analysis.
Recall that the tactic <code class="highlight coq"><span class="o">.</span> <span class="n">tac</span></code> focuses on the main goal and tries to solve it using <code class="highlight coq"><span class="n">tac</span></code>, or else fails.
It is used to structure proofs in Lean.
The notation <code class="highlight coq"><span class="o">â€¹</span><span class="n">e</span><span class="o">â€º</span></code> is just syntax sugar for <code class="highlight coq"><span class="o">(</span><span class="bp">by</span> <span class="bp">assumption</span> <span class="o">:</span> <span class="n">e</span><span class="o">)</span></code>. That is, it tries to find a hypothesis <code class="highlight coq"><span class="n">h</span> <span class="o">:</span> <span class="n">e</span></code>.
It is useful to access hypothesis that have auto generated names (aka &quot;inaccessible&quot;) names.</p>
<pre class="alectryon-io type-info-hidden highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><div class="alectryon-token"><span class="kd">theorem</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Tree.forall_insert_of_forall</var><b>: </b><span>âˆ€ {x : Type u_1} {p : Nat â†’ x â†’ Prop} {t : Tree x} {key : Nat} {value : x},
  ForallTree p t â†’ p key value â†’ ForallTree p (insert t key value)</span></span></div></blockquote></div></small></div>Tree.forall_insert_of_forall</div><div class="alectryon-token">
        (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>hâ‚</var><b>: </b><span>ForallTree p t</span></span></div></blockquote></div></small></div><span class="nv">hâ‚</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ForallTree</var><b>: </b><span>{Î² : Type u_1} â†’ (Nat â†’ Î² â†’ Prop) â†’ Tree Î² â†’ Prop</span></span></div></blockquote></div></small></div>ForallTree</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>p</var><b>: </b><span>Nat â†’ ?m.7304 â†’ Prop</span></span></div></blockquote></div></small></div><span class="nv">p</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t</var><b>: </b><span>Tree ?m.7304</span></span></div></blockquote></div></small></div><span class="nv">t</span></div><div class="alectryon-token">) (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>hâ‚‚</var><b>: </b><span>p key value</span></span></div></blockquote></div></small></div><span class="nv">hâ‚‚</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>p</var><b>: </b><span>Nat â†’ ?m.7304 â†’ Prop</span></span></div></blockquote></div></small></div><span class="nv">p</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>key</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">key</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>value</var><b>: </b><span>?m.7304</span></span></div></blockquote></div></small></div><span class="nv">value</span></div><div class="alectryon-token">)
        : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ForallTree</var><b>: </b><span>{Î² : Type u_1} â†’ (Nat â†’ Î² â†’ Prop) â†’ Tree Î² â†’ Prop</span></span></div></blockquote></div></small></div>ForallTree</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>p</var><b>: </b><span>Nat â†’ ?m.7304 â†’ Prop</span></span></div></blockquote></div></small></div><span class="nv">p</span></div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t</var><b>: </b><span>Tree ?m.7304</span></span></div></blockquote></div></small></div><span class="nv">t</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>insert</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î² â†’ Nat â†’ Î² â†’ Tree Î²</span></span></div></blockquote></div></small></div>insert</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>key</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">key</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>value</var><b>: </b><span>?m.7304</span></span></div></blockquote></div></small></div><span class="nv">value</span></div><div class="alectryon-token">) := </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chkc" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chkc"><div class="alectryon-token"><span class="kd">by</span></div><div class="alectryon-token"></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>xâœ</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>Nat <span class="bp">â†’</span> x<span class="bp">âœ</span> <span class="bp">â†’</span> <span class="kt">Prop</span></span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>Tree x<span class="bp">âœ</span></span></span></span><br><span><var>key</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>x<span class="bp">âœ</span></span></span></span><br><span><var>hâ‚</var><span class="hyp-type"><b>: </b><span>ForallTree p t</span></span></span><br><span><var>hâ‚‚</var><span class="hyp-type"><b>: </b><span>p key value</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ForallTree p (insert t key value)</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
  </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chkd" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chkd"><div class="alectryon-token"><span class="k">induction</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>hâ‚</var><b>: </b><span>ForallTree p t</span></span></div></blockquote></div></small></div><span class="nv">hâ‚</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><span class="k">with</span></div><div class="alectryon-token"></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>xâœ</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>Nat <span class="bp">â†’</span> x<span class="bp">âœ</span> <span class="bp">â†’</span> <span class="kt">Prop</span></span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>Tree x<span class="bp">âœ</span></span></span></span><br><span><var>key</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>x<span class="bp">âœ</span></span></span></span><br><span><var>hâ‚</var><span class="hyp-type"><b>: </b><span>ForallTree p t</span></span></span><br><span><var>hâ‚‚</var><span class="hyp-type"><b>: </b><span>p key value</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">ForallTree p (insert t key value)</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
  </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chke" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chke"><div class="alectryon-token"><span class="bp">|</span> leaf <span class="bp">=&gt;</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>xâœ</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>Nat <span class="bp">â†’</span> x<span class="bp">âœ</span> <span class="bp">â†’</span> <span class="kt">Prop</span></span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>Tree x<span class="bp">âœ</span></span></span></span><br><span><var>key</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>x<span class="bp">âœ</span></span></span></span><br><span><var>hâ‚‚</var><span class="hyp-type"><b>: </b><span>p key value</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">leaf</span></span><div class="goal-conclusion">ForallTree p (insert leaf key value)</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"> </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chkf" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chkf"><div class="alectryon-token"><span class="k">exact</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.node</var><b>: </b><span>âˆ€ {Î² : Type u_1} {p : Nat â†’ Î² â†’ Prop} {left : Tree Î²} {key : Nat} {value : Î²} {right : Tree Î²},
  ForallTree p left â†’ p key value â†’ ForallTree p right â†’ ForallTree p (node left key value right)</span></span></div></blockquote></div></small></div><span class="bp">.</span>node</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.leaf</var><b>: </b><span>âˆ€ {Î² : Type u_1} {p : Nat â†’ Î² â†’ Prop}, ForallTree p leaf</span></span></div></blockquote></div></small></div><span class="bp">.</span>leaf</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>hâ‚‚</var><b>: </b><span>p key value</span></span></div></blockquote></div></small></div><span class="nv">hâ‚‚</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.leaf</var><b>: </b><span>âˆ€ {Î² : Type u_1} {p : Nat â†’ Î² â†’ Prop}, ForallTree p leaf</span></span></div></blockquote></div></small></div><span class="bp">.</span>leaf</div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Goals accomplished<span class="bp">!</span> <span class="bp">ğŸ™</span></div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
  </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk10" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk10"><div class="alectryon-token"><span class="bp">|</span> node hl hp hr ihl ihr <span class="bp">=&gt;</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>xâœ</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>Nat <span class="bp">â†’</span> x<span class="bp">âœ</span> <span class="bp">â†’</span> <span class="kt">Prop</span></span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>Tree x<span class="bp">âœ</span></span></span></span><br><span><var>key</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>x<span class="bp">âœ</span></span></span></span><br><span><var>hâ‚‚</var><span class="hyp-type"><b>: </b><span>p key value</span></span></span><br><span><var>leftâœ</var><span class="hyp-type"><b>: </b><span>Tree x<span class="bp">âœ</span></span></span></span><br><span><var>keyâœ</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>valueâœ</var><span class="hyp-type"><b>: </b><span>x<span class="bp">âœ</span></span></span></span><br><span><var>rightâœ</var><span class="hyp-type"><b>: </b><span>Tree x<span class="bp">âœ</span></span></span></span><br><span><var>hl</var><span class="hyp-type"><b>: </b><span>ForallTree p left<span class="bp">âœ</span></span></span></span><br><span><var>hp</var><span class="hyp-type"><b>: </b><span>p key<span class="bp">âœ</span> value<span class="bp">âœ</span></span></span></span><br><span><var>hr</var><span class="hyp-type"><b>: </b><span>ForallTree p right<span class="bp">âœ</span></span></span></span><br><span><var>ihl</var><span class="hyp-type"><b>: </b><span>ForallTree p (insert left<span class="bp">âœ</span> key value)</span></span></span><br><span><var>ihr</var><span class="hyp-type"><b>: </b><span>ForallTree p (insert right<span class="bp">âœ</span> key value)</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">node</span></span><div class="goal-conclusion">ForallTree p (insert (node left<span class="bp">âœ</span> key<span class="bp">âœ</span> value<span class="bp">âœ</span> right<span class="bp">âœ</span>) key value)</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
    </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk11" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk11"><div class="alectryon-token"><span class="k">rename</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Nat</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div>Nat</div><div class="alectryon-token"> <span class="bp">=&gt;</span> k</div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>xâœ</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>Nat <span class="bp">â†’</span> x<span class="bp">âœ</span> <span class="bp">â†’</span> <span class="kt">Prop</span></span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>Tree x<span class="bp">âœ</span></span></span></span><br><span><var>key</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>x<span class="bp">âœ</span></span></span></span><br><span><var>hâ‚‚</var><span class="hyp-type"><b>: </b><span>p key value</span></span></span><br><span><var>leftâœ</var><span class="hyp-type"><b>: </b><span>Tree x<span class="bp">âœ</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>valueâœ</var><span class="hyp-type"><b>: </b><span>x<span class="bp">âœ</span></span></span></span><br><span><var>rightâœ</var><span class="hyp-type"><b>: </b><span>Tree x<span class="bp">âœ</span></span></span></span><br><span><var>hl</var><span class="hyp-type"><b>: </b><span>ForallTree p left<span class="bp">âœ</span></span></span></span><br><span><var>hp</var><span class="hyp-type"><b>: </b><span>p k value<span class="bp">âœ</span></span></span></span><br><span><var>hr</var><span class="hyp-type"><b>: </b><span>ForallTree p right<span class="bp">âœ</span></span></span></span><br><span><var>ihl</var><span class="hyp-type"><b>: </b><span>ForallTree p (insert left<span class="bp">âœ</span> key value)</span></span></span><br><span><var>ihr</var><span class="hyp-type"><b>: </b><span>ForallTree p (insert right<span class="bp">âœ</span> key value)</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">node</span></span><div class="goal-conclusion">ForallTree p (insert (node left<span class="bp">âœ</span> k value<span class="bp">âœ</span> right<span class="bp">âœ</span>) key value)</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
    </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk12" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk12"><div class="alectryon-token"><span class="k">by_cases&#39;</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>key</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">key</span></div><div class="alectryon-token"> <span class="bp">&lt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>xâœ</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>Nat <span class="bp">â†’</span> x<span class="bp">âœ</span> <span class="bp">â†’</span> <span class="kt">Prop</span></span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>Tree x<span class="bp">âœ</span></span></span></span><br><span><var>key</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>x<span class="bp">âœ</span></span></span></span><br><span><var>hâ‚‚</var><span class="hyp-type"><b>: </b><span>p key value</span></span></span><br><span><var>leftâœ</var><span class="hyp-type"><b>: </b><span>Tree x<span class="bp">âœ</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>valueâœ</var><span class="hyp-type"><b>: </b><span>x<span class="bp">âœ</span></span></span></span><br><span><var>rightâœ</var><span class="hyp-type"><b>: </b><span>Tree x<span class="bp">âœ</span></span></span></span><br><span><var>hl</var><span class="hyp-type"><b>: </b><span>ForallTree p left<span class="bp">âœ</span></span></span></span><br><span><var>hp</var><span class="hyp-type"><b>: </b><span>p k value<span class="bp">âœ</span></span></span></span><br><span><var>hr</var><span class="hyp-type"><b>: </b><span>ForallTree p right<span class="bp">âœ</span></span></span></span><br><span><var>ihl</var><span class="hyp-type"><b>: </b><span>ForallTree p (insert left<span class="bp">âœ</span> key value)</span></span></span><br><span><var>ihr</var><span class="hyp-type"><b>: </b><span>ForallTree p (insert right<span class="bp">âœ</span> key value)</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">node.inl</span></span><div class="goal-conclusion">ForallTree p (node (insert left<span class="bp">âœ</span> key value) k value<span class="bp">âœ</span> right<span class="bp">âœ</span>)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk13" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>xâœ</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>Nat <span class="bp">â†’</span> x<span class="bp">âœ</span> <span class="bp">â†’</span> <span class="kt">Prop</span></span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>Tree x<span class="bp">âœ</span></span></span></span><br><span><var>key</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>x<span class="bp">âœ</span></span></span></span><br><span><var>hâ‚‚</var><span class="hyp-type"><b>: </b><span>p key value</span></span></span><br><span><var>leftâœ</var><span class="hyp-type"><b>: </b><span>Tree x<span class="bp">âœ</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>valueâœ</var><span class="hyp-type"><b>: </b><span>x<span class="bp">âœ</span></span></span></span><br><span><var>rightâœ</var><span class="hyp-type"><b>: </b><span>Tree x<span class="bp">âœ</span></span></span></span><br><span><var>hl</var><span class="hyp-type"><b>: </b><span>ForallTree p left<span class="bp">âœ</span></span></span></span><br><span><var>hp</var><span class="hyp-type"><b>: </b><span>p k value<span class="bp">âœ</span></span></span></span><br><span><var>hr</var><span class="hyp-type"><b>: </b><span>ForallTree p right<span class="bp">âœ</span></span></span></span><br><span><var>ihl</var><span class="hyp-type"><b>: </b><span>ForallTree p (insert left<span class="bp">âœ</span> key value)</span></span></span><br><span><var>ihr</var><span class="hyp-type"><b>: </b><span>ForallTree p (insert right<span class="bp">âœ</span> key value)</span></span></span><br></div><label class="goal-separator" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk13"><hr><span class="goal-name">node.inr</span></label><div class="goal-conclusion">ForallTree p (<span class="k">if</span> k <span class="bp">&lt;</span> key <span class="k">then</span> node left<span class="bp">âœ</span> k value<span class="bp">âœ</span> (insert right<span class="bp">âœ</span> key value) <span class="k">else</span> node left<span class="bp">âœ</span> key value right<span class="bp">âœ</span>)</div></blockquote></div></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
    </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk14" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk14"><div class="alectryon-token"><span class="bp">.</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>xâœ</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>Nat <span class="bp">â†’</span> x<span class="bp">âœ</span> <span class="bp">â†’</span> <span class="kt">Prop</span></span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>Tree x<span class="bp">âœ</span></span></span></span><br><span><var>key</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>x<span class="bp">âœ</span></span></span></span><br><span><var>hâ‚‚</var><span class="hyp-type"><b>: </b><span>p key value</span></span></span><br><span><var>leftâœ</var><span class="hyp-type"><b>: </b><span>Tree x<span class="bp">âœ</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>valueâœ</var><span class="hyp-type"><b>: </b><span>x<span class="bp">âœ</span></span></span></span><br><span><var>rightâœ</var><span class="hyp-type"><b>: </b><span>Tree x<span class="bp">âœ</span></span></span></span><br><span><var>hl</var><span class="hyp-type"><b>: </b><span>ForallTree p left<span class="bp">âœ</span></span></span></span><br><span><var>hp</var><span class="hyp-type"><b>: </b><span>p k value<span class="bp">âœ</span></span></span></span><br><span><var>hr</var><span class="hyp-type"><b>: </b><span>ForallTree p right<span class="bp">âœ</span></span></span></span><br><span><var>ihl</var><span class="hyp-type"><b>: </b><span>ForallTree p (insert left<span class="bp">âœ</span> key value)</span></span></span><br><span><var>ihr</var><span class="hyp-type"><b>: </b><span>ForallTree p (insert right<span class="bp">âœ</span> key value)</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">node.inl</span></span><div class="goal-conclusion">ForallTree p (node (insert left<span class="bp">âœ</span> key value) k value<span class="bp">âœ</span> right<span class="bp">âœ</span>)</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"> </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk15" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk15"><div class="alectryon-token"><span class="k">exact</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.node</var><b>: </b><span>âˆ€ {Î² : Type u_1} {p : Nat â†’ Î² â†’ Prop} {left : Tree Î²} {key : Nat} {value : Î²} {right : Tree Î²},
  ForallTree p left â†’ p key value â†’ ForallTree p right â†’ ForallTree p (node left key value right)</span></span></div></blockquote></div></small></div><span class="bp">.</span>node</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ihl</var><b>: </b><span>ForallTree p (insert leftâœ key value)</span></span></div></blockquote></div></small></div><span class="nv">ihl</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>hp</var><b>: </b><span>p k valueâœ</span></span></div></blockquote></div></small></div><span class="nv">hp</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>hr</var><b>: </b><span>ForallTree p rightâœ</span></span></div></blockquote></div></small></div><span class="nv">hr</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Goals accomplished<span class="bp">!</span> <span class="bp">ğŸ™</span></div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
    </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk16" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk16"><div class="alectryon-token"><span class="bp">.</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>xâœ</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>Nat <span class="bp">â†’</span> x<span class="bp">âœ</span> <span class="bp">â†’</span> <span class="kt">Prop</span></span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>Tree x<span class="bp">âœ</span></span></span></span><br><span><var>key</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>x<span class="bp">âœ</span></span></span></span><br><span><var>hâ‚‚</var><span class="hyp-type"><b>: </b><span>p key value</span></span></span><br><span><var>leftâœ</var><span class="hyp-type"><b>: </b><span>Tree x<span class="bp">âœ</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>valueâœ</var><span class="hyp-type"><b>: </b><span>x<span class="bp">âœ</span></span></span></span><br><span><var>rightâœ</var><span class="hyp-type"><b>: </b><span>Tree x<span class="bp">âœ</span></span></span></span><br><span><var>hl</var><span class="hyp-type"><b>: </b><span>ForallTree p left<span class="bp">âœ</span></span></span></span><br><span><var>hp</var><span class="hyp-type"><b>: </b><span>p k value<span class="bp">âœ</span></span></span></span><br><span><var>hr</var><span class="hyp-type"><b>: </b><span>ForallTree p right<span class="bp">âœ</span></span></span></span><br><span><var>ihl</var><span class="hyp-type"><b>: </b><span>ForallTree p (insert left<span class="bp">âœ</span> key value)</span></span></span><br><span><var>ihr</var><span class="hyp-type"><b>: </b><span>ForallTree p (insert right<span class="bp">âœ</span> key value)</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">node.inr</span></span><div class="goal-conclusion">ForallTree p (<span class="k">if</span> k <span class="bp">&lt;</span> key <span class="k">then</span> node left<span class="bp">âœ</span> k value<span class="bp">âœ</span> (insert right<span class="bp">âœ</span> key value) <span class="k">else</span> node left<span class="bp">âœ</span> key value right<span class="bp">âœ</span>)</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"> </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk17" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk17"><div class="alectryon-token"><span class="k">by_cases&#39;</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div><div class="alectryon-token"> <span class="bp">&lt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>key</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">key</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>xâœ</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>Nat <span class="bp">â†’</span> x<span class="bp">âœ</span> <span class="bp">â†’</span> <span class="kt">Prop</span></span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>Tree x<span class="bp">âœ</span></span></span></span><br><span><var>key</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>x<span class="bp">âœ</span></span></span></span><br><span><var>hâ‚‚</var><span class="hyp-type"><b>: </b><span>p key value</span></span></span><br><span><var>leftâœ</var><span class="hyp-type"><b>: </b><span>Tree x<span class="bp">âœ</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>valueâœ</var><span class="hyp-type"><b>: </b><span>x<span class="bp">âœ</span></span></span></span><br><span><var>rightâœ</var><span class="hyp-type"><b>: </b><span>Tree x<span class="bp">âœ</span></span></span></span><br><span><var>hl</var><span class="hyp-type"><b>: </b><span>ForallTree p left<span class="bp">âœ</span></span></span></span><br><span><var>hp</var><span class="hyp-type"><b>: </b><span>p k value<span class="bp">âœ</span></span></span></span><br><span><var>hr</var><span class="hyp-type"><b>: </b><span>ForallTree p right<span class="bp">âœ</span></span></span></span><br><span><var>ihl</var><span class="hyp-type"><b>: </b><span>ForallTree p (insert left<span class="bp">âœ</span> key value)</span></span></span><br><span><var>ihr</var><span class="hyp-type"><b>: </b><span>ForallTree p (insert right<span class="bp">âœ</span> key value)</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">node.inr.inl</span></span><div class="goal-conclusion">ForallTree p (node left<span class="bp">âœ</span> k value<span class="bp">âœ</span> (insert right<span class="bp">âœ</span> key value))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk18" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>xâœ</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>Nat <span class="bp">â†’</span> x<span class="bp">âœ</span> <span class="bp">â†’</span> <span class="kt">Prop</span></span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>Tree x<span class="bp">âœ</span></span></span></span><br><span><var>key</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>x<span class="bp">âœ</span></span></span></span><br><span><var>hâ‚‚</var><span class="hyp-type"><b>: </b><span>p key value</span></span></span><br><span><var>leftâœ</var><span class="hyp-type"><b>: </b><span>Tree x<span class="bp">âœ</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>valueâœ</var><span class="hyp-type"><b>: </b><span>x<span class="bp">âœ</span></span></span></span><br><span><var>rightâœ</var><span class="hyp-type"><b>: </b><span>Tree x<span class="bp">âœ</span></span></span></span><br><span><var>hl</var><span class="hyp-type"><b>: </b><span>ForallTree p left<span class="bp">âœ</span></span></span></span><br><span><var>hp</var><span class="hyp-type"><b>: </b><span>p k value<span class="bp">âœ</span></span></span></span><br><span><var>hr</var><span class="hyp-type"><b>: </b><span>ForallTree p right<span class="bp">âœ</span></span></span></span><br><span><var>ihl</var><span class="hyp-type"><b>: </b><span>ForallTree p (insert left<span class="bp">âœ</span> key value)</span></span></span><br><span><var>ihr</var><span class="hyp-type"><b>: </b><span>ForallTree p (insert right<span class="bp">âœ</span> key value)</span></span></span><br></div><label class="goal-separator" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk18"><hr><span class="goal-name">node.inr.inr</span></label><div class="goal-conclusion">ForallTree p (node left<span class="bp">âœ</span> key value right<span class="bp">âœ</span>)</div></blockquote></div></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
      </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk19" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk19"><div class="alectryon-token"><span class="bp">.</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>xâœ</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>Nat <span class="bp">â†’</span> x<span class="bp">âœ</span> <span class="bp">â†’</span> <span class="kt">Prop</span></span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>Tree x<span class="bp">âœ</span></span></span></span><br><span><var>key</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>x<span class="bp">âœ</span></span></span></span><br><span><var>hâ‚‚</var><span class="hyp-type"><b>: </b><span>p key value</span></span></span><br><span><var>leftâœ</var><span class="hyp-type"><b>: </b><span>Tree x<span class="bp">âœ</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>valueâœ</var><span class="hyp-type"><b>: </b><span>x<span class="bp">âœ</span></span></span></span><br><span><var>rightâœ</var><span class="hyp-type"><b>: </b><span>Tree x<span class="bp">âœ</span></span></span></span><br><span><var>hl</var><span class="hyp-type"><b>: </b><span>ForallTree p left<span class="bp">âœ</span></span></span></span><br><span><var>hp</var><span class="hyp-type"><b>: </b><span>p k value<span class="bp">âœ</span></span></span></span><br><span><var>hr</var><span class="hyp-type"><b>: </b><span>ForallTree p right<span class="bp">âœ</span></span></span></span><br><span><var>ihl</var><span class="hyp-type"><b>: </b><span>ForallTree p (insert left<span class="bp">âœ</span> key value)</span></span></span><br><span><var>ihr</var><span class="hyp-type"><b>: </b><span>ForallTree p (insert right<span class="bp">âœ</span> key value)</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">node.inr.inl</span></span><div class="goal-conclusion">ForallTree p (node left<span class="bp">âœ</span> k value<span class="bp">âœ</span> (insert right<span class="bp">âœ</span> key value))</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"> </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk1a" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk1a"><div class="alectryon-token"><span class="k">exact</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.node</var><b>: </b><span>âˆ€ {Î² : Type u_1} {p : Nat â†’ Î² â†’ Prop} {left : Tree Î²} {key : Nat} {value : Î²} {right : Tree Î²},
  ForallTree p left â†’ p key value â†’ ForallTree p right â†’ ForallTree p (node left key value right)</span></span></div></blockquote></div></small></div><span class="bp">.</span>node</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>hl</var><b>: </b><span>ForallTree p leftâœ</span></span></div></blockquote></div></small></div><span class="nv">hl</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>hp</var><b>: </b><span>p k valueâœ</span></span></div></blockquote></div></small></div><span class="nv">hp</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ihr</var><b>: </b><span>ForallTree p (insert rightâœ key value)</span></span></div></blockquote></div></small></div><span class="nv">ihr</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Goals accomplished<span class="bp">!</span> <span class="bp">ğŸ™</span></div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
      </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk1b" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk1b"><div class="alectryon-token"><span class="bp">.</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>xâœ</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>Nat <span class="bp">â†’</span> x<span class="bp">âœ</span> <span class="bp">â†’</span> <span class="kt">Prop</span></span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>Tree x<span class="bp">âœ</span></span></span></span><br><span><var>key</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>x<span class="bp">âœ</span></span></span></span><br><span><var>hâ‚‚</var><span class="hyp-type"><b>: </b><span>p key value</span></span></span><br><span><var>leftâœ</var><span class="hyp-type"><b>: </b><span>Tree x<span class="bp">âœ</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>valueâœ</var><span class="hyp-type"><b>: </b><span>x<span class="bp">âœ</span></span></span></span><br><span><var>rightâœ</var><span class="hyp-type"><b>: </b><span>Tree x<span class="bp">âœ</span></span></span></span><br><span><var>hl</var><span class="hyp-type"><b>: </b><span>ForallTree p left<span class="bp">âœ</span></span></span></span><br><span><var>hp</var><span class="hyp-type"><b>: </b><span>p k value<span class="bp">âœ</span></span></span></span><br><span><var>hr</var><span class="hyp-type"><b>: </b><span>ForallTree p right<span class="bp">âœ</span></span></span></span><br><span><var>ihl</var><span class="hyp-type"><b>: </b><span>ForallTree p (insert left<span class="bp">âœ</span> key value)</span></span></span><br><span><var>ihr</var><span class="hyp-type"><b>: </b><span>ForallTree p (insert right<span class="bp">âœ</span> key value)</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">node.inr.inr</span></span><div class="goal-conclusion">ForallTree p (node left<span class="bp">âœ</span> key value right<span class="bp">âœ</span>)</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"> </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk1c" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk1c"><div class="alectryon-token"><span class="k">have_eq</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>key</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">key</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>xâœ</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>p</var><span class="hyp-type"><b>: </b><span>Nat <span class="bp">â†’</span> x<span class="bp">âœ</span> <span class="bp">â†’</span> <span class="kt">Prop</span></span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>Tree x<span class="bp">âœ</span></span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>x<span class="bp">âœ</span></span></span></span><br><span><var>leftâœ</var><span class="hyp-type"><b>: </b><span>Tree x<span class="bp">âœ</span></span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>valueâœ</var><span class="hyp-type"><b>: </b><span>x<span class="bp">âœ</span></span></span></span><br><span><var>rightâœ</var><span class="hyp-type"><b>: </b><span>Tree x<span class="bp">âœ</span></span></span></span><br><span><var>hl</var><span class="hyp-type"><b>: </b><span>ForallTree p left<span class="bp">âœ</span></span></span></span><br><span><var>hp</var><span class="hyp-type"><b>: </b><span>p k value<span class="bp">âœ</span></span></span></span><br><span><var>hr</var><span class="hyp-type"><b>: </b><span>ForallTree p right<span class="bp">âœ</span></span></span></span><br><span><var>hâ‚‚</var><span class="hyp-type"><b>: </b><span>p k value</span></span></span><br><span><var>ihl</var><span class="hyp-type"><b>: </b><span>ForallTree p (insert left<span class="bp">âœ</span> k value)</span></span></span><br><span><var>ihr</var><span class="hyp-type"><b>: </b><span>ForallTree p (insert right<span class="bp">âœ</span> k value)</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">node.inr.inr</span></span><div class="goal-conclusion">ForallTree p (node left<span class="bp">âœ</span> k value right<span class="bp">âœ</span>)</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
        </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk1d" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk1d"><div class="alectryon-token"><span class="k">exact</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.node</var><b>: </b><span>âˆ€ {Î² : Type u_1} {p : Nat â†’ Î² â†’ Prop} {left : Tree Î²} {key : Nat} {value : Î²} {right : Tree Î²},
  ForallTree p left â†’ p key value â†’ ForallTree p right â†’ ForallTree p (node left key value right)</span></span></div></blockquote></div></small></div><span class="bp">.</span>node</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>hl</var><b>: </b><span>ForallTree p leftâœ</span></span></div></blockquote></div></small></div><span class="nv">hl</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>hâ‚‚</var><b>: </b><span>p k value</span></span></div></blockquote></div></small></div><span class="nv">hâ‚‚</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>hr</var><b>: </b><span>ForallTree p rightâœ</span></span></div></blockquote></div></small></div><span class="nv">hr</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Goals accomplished<span class="bp">!</span> <span class="bp">ğŸ™</span></div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">

</div><div class="alectryon-token"><span class="kd">theorem</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Tree.bst_insert_of_bst</var><b>: </b><span>âˆ€ {Î² : Type u_1} {t : Tree Î²}, BST t â†’ âˆ€ (key : Nat) (value : Î²), BST (insert t key value)</span></span></div></blockquote></div></small></div>Tree.bst_insert_of_bst</div><div class="alectryon-token">
        {</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">t</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Tree</var><b>: </b><span>Type u_1 â†’ Type u_1</span></span></div></blockquote></div></small></div>Tree</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Î²</var><b>: </b><span>Type u_1</span></span></div></blockquote></div></small></div><span class="nv">Î²</span></div><div class="alectryon-token">} (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h</var><b>: </b><span>BST t</span></span></div></blockquote></div></small></div><span class="nv">h</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>BST</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î² â†’ Prop</span></span></div></blockquote></div></small></div>BST</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">t</span></div><div class="alectryon-token">) (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>key</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">key</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Nat</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div>Nat</div><div class="alectryon-token">) (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>value</var><b>: </b><span>Î²</span></span></div></blockquote></div></small></div><span class="nv">value</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Î²</var><b>: </b><span>Type u_1</span></span></div></blockquote></div></small></div><span class="nv">Î²</span></div><div class="alectryon-token">)
        : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>BST</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î² â†’ Prop</span></span></div></blockquote></div></small></div>BST</div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">t</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>insert</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î² â†’ Nat â†’ Î² â†’ Tree Î²</span></span></div></blockquote></div></small></div>insert</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>key</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">key</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>value</var><b>: </b><span>Î²</span></span></div></blockquote></div></small></div><span class="nv">value</span></div><div class="alectryon-token">) := </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk1e" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk1e"><div class="alectryon-token"><span class="kd">by</span></div><div class="alectryon-token"></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>BST t</span></span></span><br><span><var>key</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">BST (insert t key value)</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
  </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk1f" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk1f"><div class="alectryon-token"><span class="k">induction</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h</var><b>: </b><span>BST t</span></span></div></blockquote></div></small></div><span class="nv">h</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><span class="k">with</span></div><div class="alectryon-token"></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>BST t</span></span></span><br><span><var>key</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">BST (insert t key value)</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
  </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk20" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk20"><div class="alectryon-token"><span class="bp">|</span> leaf <span class="bp">=&gt;</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>key</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">leaf</span></span><div class="goal-conclusion">BST (insert leaf key value)</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"> </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk21" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk21"><div class="alectryon-token"><span class="k">exact</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.node</var><b>: </b><span>âˆ€ {Î² : Type u_1} {key : Nat} {left right : Tree Î²} {value : Î²},
  ForallTree (fun k v =&gt; k &lt; key) left â†’
    ForallTree (fun k v =&gt; key &lt; k) right â†’ BST left â†’ BST right â†’ BST (node left key value right)</span></span></div></blockquote></div></small></div><span class="bp">.</span>node</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.leaf</var><b>: </b><span>âˆ€ {Î² : Type u_1} {p : Nat â†’ Î² â†’ Prop}, ForallTree p leaf</span></span></div></blockquote></div></small></div><span class="bp">.</span>leaf</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.leaf</var><b>: </b><span>âˆ€ {Î² : Type u_1} {p : Nat â†’ Î² â†’ Prop}, ForallTree p leaf</span></span></div></blockquote></div></small></div><span class="bp">.</span>leaf</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.leaf</var><b>: </b><span>âˆ€ {Î² : Type u_1}, BST leaf</span></span></div></blockquote></div></small></div><span class="bp">.</span>leaf</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.leaf</var><b>: </b><span>âˆ€ {Î² : Type u_1}, BST leaf</span></span></div></blockquote></div></small></div><span class="bp">.</span>leaf</div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Goals accomplished<span class="bp">!</span> <span class="bp">ğŸ™</span></div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
  </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk22" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk22"><div class="alectryon-token"><span class="bp">|</span> node hâ‚ hâ‚‚ bâ‚ bâ‚‚ ihâ‚ ihâ‚‚ <span class="bp">=&gt;</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>key</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>keyâœ</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>leftâœ, rightâœ</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>valueâœ</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>hâ‚</var><span class="hyp-type"><b>: </b><span>ForallTree (<span class="k">fun</span> k v <span class="bp">=&gt;</span> k <span class="bp">&lt;</span> key<span class="bp">âœ</span>) left<span class="bp">âœ</span></span></span></span><br><span><var>hâ‚‚</var><span class="hyp-type"><b>: </b><span>ForallTree (<span class="k">fun</span> k v <span class="bp">=&gt;</span> key<span class="bp">âœ</span> <span class="bp">&lt;</span> k) right<span class="bp">âœ</span></span></span></span><br><span><var>bâ‚</var><span class="hyp-type"><b>: </b><span>BST left<span class="bp">âœ</span></span></span></span><br><span><var>bâ‚‚</var><span class="hyp-type"><b>: </b><span>BST right<span class="bp">âœ</span></span></span></span><br><span><var>ihâ‚</var><span class="hyp-type"><b>: </b><span>BST (insert left<span class="bp">âœ</span> key value)</span></span></span><br><span><var>ihâ‚‚</var><span class="hyp-type"><b>: </b><span>BST (insert right<span class="bp">âœ</span> key value)</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">node</span></span><div class="goal-conclusion">BST (insert (node left<span class="bp">âœ</span> key<span class="bp">âœ</span> value<span class="bp">âœ</span> right<span class="bp">âœ</span>) key value)</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
    </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk23" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk23"><div class="alectryon-token"><span class="k">rename</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Nat</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div>Nat</div><div class="alectryon-token"> <span class="bp">=&gt;</span> k</div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>key</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>leftâœ, rightâœ</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>valueâœ</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>hâ‚</var><span class="hyp-type"><b>: </b><span>ForallTree (<span class="k">fun</span> k_1 v <span class="bp">=&gt;</span> k_1 <span class="bp">&lt;</span> k) left<span class="bp">âœ</span></span></span></span><br><span><var>hâ‚‚</var><span class="hyp-type"><b>: </b><span>ForallTree (<span class="k">fun</span> k_1 v <span class="bp">=&gt;</span> k <span class="bp">&lt;</span> k_1) right<span class="bp">âœ</span></span></span></span><br><span><var>bâ‚</var><span class="hyp-type"><b>: </b><span>BST left<span class="bp">âœ</span></span></span></span><br><span><var>bâ‚‚</var><span class="hyp-type"><b>: </b><span>BST right<span class="bp">âœ</span></span></span></span><br><span><var>ihâ‚</var><span class="hyp-type"><b>: </b><span>BST (insert left<span class="bp">âœ</span> key value)</span></span></span><br><span><var>ihâ‚‚</var><span class="hyp-type"><b>: </b><span>BST (insert right<span class="bp">âœ</span> key value)</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">node</span></span><div class="goal-conclusion">BST (insert (node left<span class="bp">âœ</span> k value<span class="bp">âœ</span> right<span class="bp">âœ</span>) key value)</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
    </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk24" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk24"><div class="alectryon-token"><span class="k">simp</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>key</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>leftâœ, rightâœ</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>valueâœ</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>hâ‚</var><span class="hyp-type"><b>: </b><span>ForallTree (<span class="k">fun</span> k_1 v <span class="bp">=&gt;</span> k_1 <span class="bp">&lt;</span> k) left<span class="bp">âœ</span></span></span></span><br><span><var>hâ‚‚</var><span class="hyp-type"><b>: </b><span>ForallTree (<span class="k">fun</span> k_1 v <span class="bp">=&gt;</span> k <span class="bp">&lt;</span> k_1) right<span class="bp">âœ</span></span></span></span><br><span><var>bâ‚</var><span class="hyp-type"><b>: </b><span>BST left<span class="bp">âœ</span></span></span></span><br><span><var>bâ‚‚</var><span class="hyp-type"><b>: </b><span>BST right<span class="bp">âœ</span></span></span></span><br><span><var>ihâ‚</var><span class="hyp-type"><b>: </b><span>BST (insert left<span class="bp">âœ</span> key value)</span></span></span><br><span><var>ihâ‚‚</var><span class="hyp-type"><b>: </b><span>BST (insert right<span class="bp">âœ</span> key value)</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">node</span></span><div class="goal-conclusion">BST
  (<span class="k">if</span> key <span class="bp">&lt;</span> k <span class="k">then</span> node (insert left<span class="bp">âœ</span> key value) k value<span class="bp">âœ</span> right<span class="bp">âœ</span>
  <span class="k">else</span> <span class="k">if</span> k <span class="bp">&lt;</span> key <span class="k">then</span> node left<span class="bp">âœ</span> k value<span class="bp">âœ</span> (insert right<span class="bp">âœ</span> key value) <span class="k">else</span> node left<span class="bp">âœ</span> key value right<span class="bp">âœ</span>)</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
    </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk25" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk25"><div class="alectryon-token"><span class="k">by_cases&#39;</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>key</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">key</span></div><div class="alectryon-token"> <span class="bp">&lt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>key</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>leftâœ, rightâœ</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>valueâœ</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>hâ‚</var><span class="hyp-type"><b>: </b><span>ForallTree (<span class="k">fun</span> k_1 v <span class="bp">=&gt;</span> k_1 <span class="bp">&lt;</span> k) left<span class="bp">âœ</span></span></span></span><br><span><var>hâ‚‚</var><span class="hyp-type"><b>: </b><span>ForallTree (<span class="k">fun</span> k_1 v <span class="bp">=&gt;</span> k <span class="bp">&lt;</span> k_1) right<span class="bp">âœ</span></span></span></span><br><span><var>bâ‚</var><span class="hyp-type"><b>: </b><span>BST left<span class="bp">âœ</span></span></span></span><br><span><var>bâ‚‚</var><span class="hyp-type"><b>: </b><span>BST right<span class="bp">âœ</span></span></span></span><br><span><var>ihâ‚</var><span class="hyp-type"><b>: </b><span>BST (insert left<span class="bp">âœ</span> key value)</span></span></span><br><span><var>ihâ‚‚</var><span class="hyp-type"><b>: </b><span>BST (insert right<span class="bp">âœ</span> key value)</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">node.inl</span></span><div class="goal-conclusion">BST (node (insert left<span class="bp">âœ</span> key value) k value<span class="bp">âœ</span> right<span class="bp">âœ</span>)</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk26" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>key</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>leftâœ, rightâœ</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>valueâœ</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>hâ‚</var><span class="hyp-type"><b>: </b><span>ForallTree (<span class="k">fun</span> k_1 v <span class="bp">=&gt;</span> k_1 <span class="bp">&lt;</span> k) left<span class="bp">âœ</span></span></span></span><br><span><var>hâ‚‚</var><span class="hyp-type"><b>: </b><span>ForallTree (<span class="k">fun</span> k_1 v <span class="bp">=&gt;</span> k <span class="bp">&lt;</span> k_1) right<span class="bp">âœ</span></span></span></span><br><span><var>bâ‚</var><span class="hyp-type"><b>: </b><span>BST left<span class="bp">âœ</span></span></span></span><br><span><var>bâ‚‚</var><span class="hyp-type"><b>: </b><span>BST right<span class="bp">âœ</span></span></span></span><br><span><var>ihâ‚</var><span class="hyp-type"><b>: </b><span>BST (insert left<span class="bp">âœ</span> key value)</span></span></span><br><span><var>ihâ‚‚</var><span class="hyp-type"><b>: </b><span>BST (insert right<span class="bp">âœ</span> key value)</span></span></span><br></div><label class="goal-separator" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk26"><hr><span class="goal-name">node.inr</span></label><div class="goal-conclusion">BST (<span class="k">if</span> k <span class="bp">&lt;</span> key <span class="k">then</span> node left<span class="bp">âœ</span> k value<span class="bp">âœ</span> (insert right<span class="bp">âœ</span> key value) <span class="k">else</span> node left<span class="bp">âœ</span> key value right<span class="bp">âœ</span>)</div></blockquote></div></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
    </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk27" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk27"><div class="alectryon-token"><span class="bp">.</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>key</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>leftâœ, rightâœ</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>valueâœ</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>hâ‚</var><span class="hyp-type"><b>: </b><span>ForallTree (<span class="k">fun</span> k_1 v <span class="bp">=&gt;</span> k_1 <span class="bp">&lt;</span> k) left<span class="bp">âœ</span></span></span></span><br><span><var>hâ‚‚</var><span class="hyp-type"><b>: </b><span>ForallTree (<span class="k">fun</span> k_1 v <span class="bp">=&gt;</span> k <span class="bp">&lt;</span> k_1) right<span class="bp">âœ</span></span></span></span><br><span><var>bâ‚</var><span class="hyp-type"><b>: </b><span>BST left<span class="bp">âœ</span></span></span></span><br><span><var>bâ‚‚</var><span class="hyp-type"><b>: </b><span>BST right<span class="bp">âœ</span></span></span></span><br><span><var>ihâ‚</var><span class="hyp-type"><b>: </b><span>BST (insert left<span class="bp">âœ</span> key value)</span></span></span><br><span><var>ihâ‚‚</var><span class="hyp-type"><b>: </b><span>BST (insert right<span class="bp">âœ</span> key value)</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">node.inl</span></span><div class="goal-conclusion">BST (node (insert left<span class="bp">âœ</span> key value) k value<span class="bp">âœ</span> right<span class="bp">âœ</span>)</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"> </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk28" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk28"><div class="alectryon-token"><span class="k">exact</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.node</var><b>: </b><span>âˆ€ {Î² : Type u_1} {key : Nat} {left right : Tree Î²} {value : Î²},
  ForallTree (fun k v =&gt; k &lt; key) left â†’
    ForallTree (fun k v =&gt; key &lt; k) right â†’ BST left â†’ BST right â†’ BST (node left key value right)</span></span></div></blockquote></div></small></div><span class="bp">.</span>node</div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>forall_insert_of_forall</var><b>: </b><span>âˆ€ {x : Type u_1} {p : Nat â†’ x â†’ Prop} {t : Tree x} {key : Nat} {value : x},
  ForallTree p t â†’ p key value â†’ ForallTree p (insert t key value)</span></span></div></blockquote></div></small></div>forall_insert_of_forall</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>hâ‚</var><b>: </b><span>ForallTree (fun k_1 v =&gt; k_1 &lt; k) leftâœ</span></span></div></blockquote></div></small></div><span class="nv">hâ‚</span></div><div class="alectryon-token"> â€¹key <span class="bp">&lt;</span> kâ€º) </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>hâ‚‚</var><b>: </b><span>ForallTree (fun k_1 v =&gt; k &lt; k_1) rightâœ</span></span></div></blockquote></div></small></div><span class="nv">hâ‚‚</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ihâ‚</var><b>: </b><span>BST (insert leftâœ key value)</span></span></div></blockquote></div></small></div><span class="nv">ihâ‚</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>bâ‚‚</var><b>: </b><span>BST rightâœ</span></span></div></blockquote></div></small></div><span class="nv">bâ‚‚</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Goals accomplished<span class="bp">!</span> <span class="bp">ğŸ™</span></div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
    </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk29" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk29"><div class="alectryon-token"><span class="bp">.</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>key</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>leftâœ, rightâœ</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>valueâœ</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>hâ‚</var><span class="hyp-type"><b>: </b><span>ForallTree (<span class="k">fun</span> k_1 v <span class="bp">=&gt;</span> k_1 <span class="bp">&lt;</span> k) left<span class="bp">âœ</span></span></span></span><br><span><var>hâ‚‚</var><span class="hyp-type"><b>: </b><span>ForallTree (<span class="k">fun</span> k_1 v <span class="bp">=&gt;</span> k <span class="bp">&lt;</span> k_1) right<span class="bp">âœ</span></span></span></span><br><span><var>bâ‚</var><span class="hyp-type"><b>: </b><span>BST left<span class="bp">âœ</span></span></span></span><br><span><var>bâ‚‚</var><span class="hyp-type"><b>: </b><span>BST right<span class="bp">âœ</span></span></span></span><br><span><var>ihâ‚</var><span class="hyp-type"><b>: </b><span>BST (insert left<span class="bp">âœ</span> key value)</span></span></span><br><span><var>ihâ‚‚</var><span class="hyp-type"><b>: </b><span>BST (insert right<span class="bp">âœ</span> key value)</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">node.inr</span></span><div class="goal-conclusion">BST (<span class="k">if</span> k <span class="bp">&lt;</span> key <span class="k">then</span> node left<span class="bp">âœ</span> k value<span class="bp">âœ</span> (insert right<span class="bp">âœ</span> key value) <span class="k">else</span> node left<span class="bp">âœ</span> key value right<span class="bp">âœ</span>)</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"> </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk2a" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk2a"><div class="alectryon-token"><span class="k">by_cases&#39;</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div><div class="alectryon-token"> <span class="bp">&lt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>key</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">key</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>key</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>leftâœ, rightâœ</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>valueâœ</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>hâ‚</var><span class="hyp-type"><b>: </b><span>ForallTree (<span class="k">fun</span> k_1 v <span class="bp">=&gt;</span> k_1 <span class="bp">&lt;</span> k) left<span class="bp">âœ</span></span></span></span><br><span><var>hâ‚‚</var><span class="hyp-type"><b>: </b><span>ForallTree (<span class="k">fun</span> k_1 v <span class="bp">=&gt;</span> k <span class="bp">&lt;</span> k_1) right<span class="bp">âœ</span></span></span></span><br><span><var>bâ‚</var><span class="hyp-type"><b>: </b><span>BST left<span class="bp">âœ</span></span></span></span><br><span><var>bâ‚‚</var><span class="hyp-type"><b>: </b><span>BST right<span class="bp">âœ</span></span></span></span><br><span><var>ihâ‚</var><span class="hyp-type"><b>: </b><span>BST (insert left<span class="bp">âœ</span> key value)</span></span></span><br><span><var>ihâ‚‚</var><span class="hyp-type"><b>: </b><span>BST (insert right<span class="bp">âœ</span> key value)</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">node.inr.inl</span></span><div class="goal-conclusion">BST (node left<span class="bp">âœ</span> k value<span class="bp">âœ</span> (insert right<span class="bp">âœ</span> key value))</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk2b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>key</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>leftâœ, rightâœ</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>valueâœ</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>hâ‚</var><span class="hyp-type"><b>: </b><span>ForallTree (<span class="k">fun</span> k_1 v <span class="bp">=&gt;</span> k_1 <span class="bp">&lt;</span> k) left<span class="bp">âœ</span></span></span></span><br><span><var>hâ‚‚</var><span class="hyp-type"><b>: </b><span>ForallTree (<span class="k">fun</span> k_1 v <span class="bp">=&gt;</span> k <span class="bp">&lt;</span> k_1) right<span class="bp">âœ</span></span></span></span><br><span><var>bâ‚</var><span class="hyp-type"><b>: </b><span>BST left<span class="bp">âœ</span></span></span></span><br><span><var>bâ‚‚</var><span class="hyp-type"><b>: </b><span>BST right<span class="bp">âœ</span></span></span></span><br><span><var>ihâ‚</var><span class="hyp-type"><b>: </b><span>BST (insert left<span class="bp">âœ</span> key value)</span></span></span><br><span><var>ihâ‚‚</var><span class="hyp-type"><b>: </b><span>BST (insert right<span class="bp">âœ</span> key value)</span></span></span><br></div><label class="goal-separator" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk2b"><hr><span class="goal-name">node.inr.inr</span></label><div class="goal-conclusion">BST (node left<span class="bp">âœ</span> key value right<span class="bp">âœ</span>)</div></blockquote></div></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
      </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk2c" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk2c"><div class="alectryon-token"><span class="bp">.</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>key</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>leftâœ, rightâœ</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>valueâœ</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>hâ‚</var><span class="hyp-type"><b>: </b><span>ForallTree (<span class="k">fun</span> k_1 v <span class="bp">=&gt;</span> k_1 <span class="bp">&lt;</span> k) left<span class="bp">âœ</span></span></span></span><br><span><var>hâ‚‚</var><span class="hyp-type"><b>: </b><span>ForallTree (<span class="k">fun</span> k_1 v <span class="bp">=&gt;</span> k <span class="bp">&lt;</span> k_1) right<span class="bp">âœ</span></span></span></span><br><span><var>bâ‚</var><span class="hyp-type"><b>: </b><span>BST left<span class="bp">âœ</span></span></span></span><br><span><var>bâ‚‚</var><span class="hyp-type"><b>: </b><span>BST right<span class="bp">âœ</span></span></span></span><br><span><var>ihâ‚</var><span class="hyp-type"><b>: </b><span>BST (insert left<span class="bp">âœ</span> key value)</span></span></span><br><span><var>ihâ‚‚</var><span class="hyp-type"><b>: </b><span>BST (insert right<span class="bp">âœ</span> key value)</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">node.inr.inl</span></span><div class="goal-conclusion">BST (node left<span class="bp">âœ</span> k value<span class="bp">âœ</span> (insert right<span class="bp">âœ</span> key value))</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"> </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk2d" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk2d"><div class="alectryon-token"><span class="k">exact</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.node</var><b>: </b><span>âˆ€ {Î² : Type u_1} {key : Nat} {left right : Tree Î²} {value : Î²},
  ForallTree (fun k v =&gt; k &lt; key) left â†’
    ForallTree (fun k v =&gt; key &lt; k) right â†’ BST left â†’ BST right â†’ BST (node left key value right)</span></span></div></blockquote></div></small></div><span class="bp">.</span>node</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>hâ‚</var><b>: </b><span>ForallTree (fun k_1 v =&gt; k_1 &lt; k) leftâœ</span></span></div></blockquote></div></small></div><span class="nv">hâ‚</span></div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>forall_insert_of_forall</var><b>: </b><span>âˆ€ {x : Type u_1} {p : Nat â†’ x â†’ Prop} {t : Tree x} {key : Nat} {value : x},
  ForallTree p t â†’ p key value â†’ ForallTree p (insert t key value)</span></span></div></blockquote></div></small></div>forall_insert_of_forall</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>hâ‚‚</var><b>: </b><span>ForallTree (fun k_1 v =&gt; k &lt; k_1) rightâœ</span></span></div></blockquote></div></small></div><span class="nv">hâ‚‚</span></div><div class="alectryon-token"> â€¹k <span class="bp">&lt;</span> keyâ€º) </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>bâ‚</var><b>: </b><span>BST leftâœ</span></span></div></blockquote></div></small></div><span class="nv">bâ‚</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ihâ‚‚</var><b>: </b><span>BST (insert rightâœ key value)</span></span></div></blockquote></div></small></div><span class="nv">ihâ‚‚</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Goals accomplished<span class="bp">!</span> <span class="bp">ğŸ™</span></div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
      </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk2e" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk2e"><div class="alectryon-token"><span class="bp">.</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>key</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>leftâœ, rightâœ</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>valueâœ</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>hâ‚</var><span class="hyp-type"><b>: </b><span>ForallTree (<span class="k">fun</span> k_1 v <span class="bp">=&gt;</span> k_1 <span class="bp">&lt;</span> k) left<span class="bp">âœ</span></span></span></span><br><span><var>hâ‚‚</var><span class="hyp-type"><b>: </b><span>ForallTree (<span class="k">fun</span> k_1 v <span class="bp">=&gt;</span> k <span class="bp">&lt;</span> k_1) right<span class="bp">âœ</span></span></span></span><br><span><var>bâ‚</var><span class="hyp-type"><b>: </b><span>BST left<span class="bp">âœ</span></span></span></span><br><span><var>bâ‚‚</var><span class="hyp-type"><b>: </b><span>BST right<span class="bp">âœ</span></span></span></span><br><span><var>ihâ‚</var><span class="hyp-type"><b>: </b><span>BST (insert left<span class="bp">âœ</span> key value)</span></span></span><br><span><var>ihâ‚‚</var><span class="hyp-type"><b>: </b><span>BST (insert right<span class="bp">âœ</span> key value)</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">node.inr.inr</span></span><div class="goal-conclusion">BST (node left<span class="bp">âœ</span> key value right<span class="bp">âœ</span>)</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"> </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk2f" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk2f"><div class="alectryon-token"><span class="k">have_eq</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>key</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">key</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>leftâœ, rightâœ</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>valueâœ</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>hâ‚</var><span class="hyp-type"><b>: </b><span>ForallTree (<span class="k">fun</span> k_1 v <span class="bp">=&gt;</span> k_1 <span class="bp">&lt;</span> k) left<span class="bp">âœ</span></span></span></span><br><span><var>hâ‚‚</var><span class="hyp-type"><b>: </b><span>ForallTree (<span class="k">fun</span> k_1 v <span class="bp">=&gt;</span> k <span class="bp">&lt;</span> k_1) right<span class="bp">âœ</span></span></span></span><br><span><var>bâ‚</var><span class="hyp-type"><b>: </b><span>BST left<span class="bp">âœ</span></span></span></span><br><span><var>bâ‚‚</var><span class="hyp-type"><b>: </b><span>BST right<span class="bp">âœ</span></span></span></span><br><span><var>ihâ‚</var><span class="hyp-type"><b>: </b><span>BST (insert left<span class="bp">âœ</span> k value)</span></span></span><br><span><var>ihâ‚‚</var><span class="hyp-type"><b>: </b><span>BST (insert right<span class="bp">âœ</span> k value)</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">node.inr.inr</span></span><div class="goal-conclusion">BST (node left<span class="bp">âœ</span> k value right<span class="bp">âœ</span>)</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
        </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk30" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk30"><div class="alectryon-token"><span class="k">exact</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.node</var><b>: </b><span>âˆ€ {Î² : Type u_1} {key : Nat} {left right : Tree Î²} {value : Î²},
  ForallTree (fun k v =&gt; k &lt; key) left â†’
    ForallTree (fun k v =&gt; key &lt; k) right â†’ BST left â†’ BST right â†’ BST (node left key value right)</span></span></div></blockquote></div></small></div><span class="bp">.</span>node</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>hâ‚</var><b>: </b><span>ForallTree (fun k_1 v =&gt; k_1 &lt; k) leftâœ</span></span></div></blockquote></div></small></div><span class="nv">hâ‚</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>hâ‚‚</var><b>: </b><span>ForallTree (fun k_1 v =&gt; k &lt; k_1) rightâœ</span></span></div></blockquote></div></small></div><span class="nv">hâ‚‚</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>bâ‚</var><b>: </b><span>BST leftâœ</span></span></div></blockquote></div></small></div><span class="nv">bâ‚</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>bâ‚‚</var><b>: </b><span>BST rightâœ</span></span></div></blockquote></div></small></div><span class="nv">bâ‚‚</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Goals accomplished<span class="bp">!</span> <span class="bp">ğŸ™</span></div></blockquote></div></div></small></span></pre><p>Now, we define the type <code class="highlight coq"><span class="n">BinTree</span></code> using a <code class="highlight coq"><span class="n">Subtype</span></code> that states that only trees satisfying the BST invariant are <code class="highlight coq"><span class="n">BinTree</span></code>s.</p>
<pre class="alectryon-io type-info-hidden highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><div class="alectryon-token"><span class="kd">def</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>BinTree</var><b>: </b><span>Type u â†’ Type u</span></span></div></blockquote></div></small></div>BinTree</div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Î²</var><b>: </b><span>Type u</span></span></div></blockquote></div></small></div><span class="nv">Î²</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Type u</var><b>: </b><span>Type (u + 1)</span></span></div></blockquote></div></small></div><span class="kt">Type</span> u</div><div class="alectryon-token">) := { </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">t</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Tree</var><b>: </b><span>Type u â†’ Type u</span></span></div></blockquote></div></small></div>Tree</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Î²</var><b>: </b><span>Type u</span></span></div></blockquote></div></small></div><span class="nv">Î²</span></div><div class="alectryon-token"> <span class="bp">//</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>BST</var><b>: </b><span>{Î² : Type u} â†’ Tree Î² â†’ Prop</span></span></div></blockquote></div></small></div>BST</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">t</span></div><div class="alectryon-token"> }

</div><div class="alectryon-token"><span class="kd">def</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>BinTree.mk</var><b>: </b><span>{Î² : Type u_1} â†’ BinTree Î²</span></span></div></blockquote></div></small></div>BinTree.mk</div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>BinTree</var><b>: </b><span>Type u_1 â†’ Type u_1</span></span></div></blockquote></div></small></div>BinTree</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Î²</var><b>: </b><span>Type u_1</span></span></div></blockquote></div></small></div><span class="nv">Î²</span></div><div class="alectryon-token"> :=
  âŸ¨</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.leaf</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î²</span></span></div></blockquote></div></small></div><span class="bp">.</span>leaf</div><div class="alectryon-token">, </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.leaf</var><b>: </b><span>âˆ€ {Î² : Type u_1}, BST Tree.leaf</span></span></div></blockquote></div></small></div><span class="bp">.</span>leaf</div><div class="alectryon-token">âŸ©

</div><div class="alectryon-token"><span class="kd">def</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>BinTree.contains</var><b>: </b><span>{Î² : Type u_1} â†’ BinTree Î² â†’ Nat â†’ Bool</span></span></div></blockquote></div></small></div>BinTree.contains</div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b</var><b>: </b><span>BinTree Î²</span></span></div></blockquote></div></small></div><span class="nv">b</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>BinTree</var><b>: </b><span>Type u_1 â†’ Type u_1</span></span></div></blockquote></div></small></div>BinTree</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Î²</var><b>: </b><span>Type u_1</span></span></div></blockquote></div></small></div><span class="nv">Î²</span></div><div class="alectryon-token">) (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Nat</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div>Nat</div><div class="alectryon-token">) : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Bool</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div>Bool</div><div class="alectryon-token"> :=
  </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b</var><b>: </b><span>BinTree Î²</span></span></div></blockquote></div></small></div><span class="nv">b</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>val</var><b>: </b><span>{Î± : Type u_1} â†’ {p : Î± â†’ Prop} â†’ Subtype p â†’ Î±</span></span></div></blockquote></div></small></div>val</div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>contains</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î² â†’ Nat â†’ Bool</span></span></div></blockquote></div></small></div>contains</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div><div class="alectryon-token">

</div><div class="alectryon-token"><span class="kd">def</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>BinTree.find?</var><b>: </b><span>{Î² : Type u_1} â†’ BinTree Î² â†’ Nat â†’ Option Î²</span></span></div></blockquote></div></small></div>BinTree.find<span class="bp">?</span></div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b</var><b>: </b><span>BinTree Î²</span></span></div></blockquote></div></small></div><span class="nv">b</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>BinTree</var><b>: </b><span>Type u_1 â†’ Type u_1</span></span></div></blockquote></div></small></div>BinTree</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Î²</var><b>: </b><span>Type u_1</span></span></div></blockquote></div></small></div><span class="nv">Î²</span></div><div class="alectryon-token">) (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Nat</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div>Nat</div><div class="alectryon-token">) : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Option</var><b>: </b><span>Type u_1 â†’ Type u_1</span></span></div></blockquote></div></small></div>Option</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Î²</var><b>: </b><span>Type u_1</span></span></div></blockquote></div></small></div><span class="nv">Î²</span></div><div class="alectryon-token"> :=
  </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b</var><b>: </b><span>BinTree Î²</span></span></div></blockquote></div></small></div><span class="nv">b</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>val</var><b>: </b><span>{Î± : Type u_1} â†’ {p : Î± â†’ Prop} â†’ Subtype p â†’ Î±</span></span></div></blockquote></div></small></div>val</div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>find?</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î² â†’ Nat â†’ Option Î²</span></span></div></blockquote></div></small></div>find<span class="bp">?</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div><div class="alectryon-token">

</div><div class="alectryon-token"><span class="kd">def</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>BinTree.insert</var><b>: </b><span>{Î² : Type u_1} â†’ BinTree Î² â†’ Nat â†’ Î² â†’ BinTree Î²</span></span></div></blockquote></div></small></div>BinTree.insert</div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b</var><b>: </b><span>BinTree Î²</span></span></div></blockquote></div></small></div><span class="nv">b</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>BinTree</var><b>: </b><span>Type u_1 â†’ Type u_1</span></span></div></blockquote></div></small></div>BinTree</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Î²</var><b>: </b><span>Type u_1</span></span></div></blockquote></div></small></div><span class="nv">Î²</span></div><div class="alectryon-token">) (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Nat</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div>Nat</div><div class="alectryon-token">) (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>v</var><b>: </b><span>Î²</span></span></div></blockquote></div></small></div><span class="nv">v</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Î²</var><b>: </b><span>Type u_1</span></span></div></blockquote></div></small></div><span class="nv">Î²</span></div><div class="alectryon-token">) : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>BinTree</var><b>: </b><span>Type u_1 â†’ Type u_1</span></span></div></blockquote></div></small></div>BinTree</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Î²</var><b>: </b><span>Type u_1</span></span></div></blockquote></div></small></div><span class="nv">Î²</span></div><div class="alectryon-token"> :=
  âŸ¨</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b</var><b>: </b><span>BinTree Î²</span></span></div></blockquote></div></small></div><span class="nv">b</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>val</var><b>: </b><span>{Î± : Type u_1} â†’ {p : Î± â†’ Prop} â†’ Subtype p â†’ Î±</span></span></div></blockquote></div></small></div>val</div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>insert</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î² â†’ Nat â†’ Î² â†’ Tree Î²</span></span></div></blockquote></div></small></div>insert</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>v</var><b>: </b><span>Î²</span></span></div></blockquote></div></small></div><span class="nv">v</span></div><div class="alectryon-token">, </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b</var><b>: </b><span>BinTree Î²</span></span></div></blockquote></div></small></div><span class="nv">b</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>val</var><b>: </b><span>{Î± : Type u_1} â†’ {p : Î± â†’ Prop} â†’ Subtype p â†’ Î±</span></span></div></blockquote></div></small></div>val</div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>bst_insert_of_bst</var><b>: </b><span>âˆ€ {Î² : Type u_1} {t : Tree Î²}, BST t â†’ âˆ€ (key : Nat) (value : Î²), BST (Tree.insert t key value)</span></span></div></blockquote></div></small></div>bst_insert_of_bst</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b</var><b>: </b><span>BinTree Î²</span></span></div></blockquote></div></small></div><span class="nv">b</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>property</var><b>: </b><span>âˆ€ {Î± : Type u_1} {p : Î± â†’ Prop} (self : Subtype p), p self.val</span></span></div></blockquote></div></small></div>property</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>v</var><b>: </b><span>Î²</span></span></div></blockquote></div></small></div><span class="nv">v</span></div><div class="alectryon-token">âŸ©</div></span></pre><p>Finally, we prove that <code class="highlight coq"><span class="n">BinTree</span><span class="o">.</span><span class="n">find</span><span class="o">?</span></code> and <code class="highlight coq"><span class="n">BinTree</span><span class="o">.</span><span class="n">insert</span></code> satisfy the map properties.</p>
<pre class="alectryon-io type-info-hidden highlight"><!-- Generator: Alectryon --><span class="alectryon-wsp"><div class="alectryon-token"><span class="kn">attribute</span></div><div class="alectryon-token"> [</div><div class="alectryon-token"><span class="kn">local</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><span class="k">simp</span></div><div class="alectryon-token">]
  </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>BinTree.mk</var><b>: </b><span>{Î² : Type u_1} â†’ BinTree Î²</span></span></div></blockquote></div></small></div>BinTree.mk</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>BinTree.contains</var><b>: </b><span>{Î² : Type u_1} â†’ BinTree Î² â†’ Nat â†’ Bool</span></span></div></blockquote></div></small></div>BinTree.contains</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>BinTree.find?</var><b>: </b><span>{Î² : Type u_1} â†’ BinTree Î² â†’ Nat â†’ Option Î²</span></span></div></blockquote></div></small></div>BinTree.find<span class="bp">?</span></div><div class="alectryon-token">
  </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>BinTree.insert</var><b>: </b><span>{Î² : Type u_1} â†’ BinTree Î² â†’ Nat â†’ Î² â†’ BinTree Î²</span></span></div></blockquote></div></small></div>BinTree.insert</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Tree.find?</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î² â†’ Nat â†’ Option Î²</span></span></div></blockquote></div></small></div>Tree.find<span class="bp">?</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Tree.contains</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î² â†’ Nat â†’ Bool</span></span></div></blockquote></div></small></div>Tree.contains</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Tree.insert</var><b>: </b><span>{Î² : Type u_1} â†’ Tree Î² â†’ Nat â†’ Î² â†’ Tree Î²</span></span></div></blockquote></div></small></div>Tree.insert</div><div class="alectryon-token">

</div><div class="alectryon-token"><span class="kd">theorem</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>BinTree.find_mk</var><b>: </b><span>âˆ€ {Î² : Type u_1} (k : Nat), find? mk k = none</span></span></div></blockquote></div></small></div>BinTree.find_mk</div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Nat</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div>Nat</div><div class="alectryon-token">)
        : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>BinTree.mk</var><b>: </b><span>{Î² : Type u_1} â†’ BinTree Î²</span></span></div></blockquote></div></small></div>BinTree.mk</div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>find?</var><b>: </b><span>{Î² : Type u_1} â†’ BinTree Î² â†’ Nat â†’ Option Î²</span></span></div></blockquote></div></small></div>find<span class="bp">?</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div><div class="alectryon-token"> <span class="bp">=</span> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>none</var><b>: </b><span>{Î± : Type u_1} â†’ Option Î±</span></span></div></blockquote></div></small></div>none</div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Option</var><b>: </b><span>Type u_1 â†’ Type u_1</span></span></div></blockquote></div></small></div>Option</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Î²</var><b>: </b><span>Type u_1</span></span></div></blockquote></div></small></div><span class="nv">Î²</span></div><div class="alectryon-token">) := </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk31" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk31"><div class="alectryon-token"><span class="kd">by</span></div><div class="alectryon-token"></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">find<span class="bp">?</span> mk k <span class="bp">=</span> none</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
  </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk32" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk32"><div class="alectryon-token"><span class="k">simp</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Goals accomplished<span class="bp">!</span> <span class="bp">ğŸ™</span></div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">

</div><div class="alectryon-token"><span class="kd">theorem</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>BinTree.find_insert</var><b>: </b><span>âˆ€ {Î² : Type u_1} (b : BinTree Î²) (k : Nat) (v : Î²), find? (insert b k v) k = some v</span></span></div></blockquote></div></small></div>BinTree.find_insert</div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b</var><b>: </b><span>BinTree Î²</span></span></div></blockquote></div></small></div><span class="nv">b</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>BinTree</var><b>: </b><span>Type u_1 â†’ Type u_1</span></span></div></blockquote></div></small></div>BinTree</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Î²</var><b>: </b><span>Type u_1</span></span></div></blockquote></div></small></div><span class="nv">Î²</span></div><div class="alectryon-token">) (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Nat</var><b>: </b><span>Type</span></span></div></blockquote></div></small></div>Nat</div><div class="alectryon-token">) (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>v</var><b>: </b><span>Î²</span></span></div></blockquote></div></small></div><span class="nv">v</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Î²</var><b>: </b><span>Type u_1</span></span></div></blockquote></div></small></div><span class="nv">Î²</span></div><div class="alectryon-token">)
        : (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b</var><b>: </b><span>BinTree Î²</span></span></div></blockquote></div></small></div><span class="nv">b</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>insert</var><b>: </b><span>{Î² : Type u_1} â†’ BinTree Î² â†’ Nat â†’ Î² â†’ BinTree Î²</span></span></div></blockquote></div></small></div>insert</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>v</var><b>: </b><span>Î²</span></span></div></blockquote></div></small></div><span class="nv">v</span></div><div class="alectryon-token">)<span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>find?</var><b>: </b><span>{Î² : Type u_1} â†’ BinTree Î² â†’ Nat â†’ Option Î²</span></span></div></blockquote></div></small></div>find<span class="bp">?</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div><div class="alectryon-token"> <span class="bp">=</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>some</var><b>: </b><span>{Î± : Type u_1} â†’ Î± â†’ Option Î±</span></span></div></blockquote></div></small></div>some</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>v</var><b>: </b><span>Î²</span></span></div></blockquote></div></small></div><span class="nv">v</span></div><div class="alectryon-token"> := </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk33" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk33"><div class="alectryon-token"><span class="kd">by</span></div><div class="alectryon-token"></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>BinTree Î²</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">find<span class="bp">?</span> (insert b k v) k <span class="bp">=</span> some v</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
  </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk34" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk34"><div class="alectryon-token"><span class="k">let</span></div><div class="alectryon-token"> âŸ¨</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">t</span></div><div class="alectryon-token">, </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h</var><b>: </b><span>BST t</span></span></div></blockquote></div></small></div><span class="nv">h</span></div><div class="alectryon-token">âŸ© := </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b</var><b>: </b><span>BinTree Î²</span></span></div></blockquote></div></small></div><span class="nv">b</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>BinTree Î²</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>BST t</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">find<span class="bp">?</span> (insert { val := t, property := h } k v) k <span class="bp">=</span> some v</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"><span class="bp">;</span></div><div class="alectryon-token"> </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk35" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk35"><div class="alectryon-token"><span class="k">simp</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>BinTree Î²</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>BST t</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Tree.find<span class="bp">?</span> (Tree.insert t k v) k <span class="bp">=</span> some v</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
  </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk36" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk36"><div class="alectryon-token"><span class="k">induction</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">t</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><span class="k">with</span></div><div class="alectryon-token"></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>BinTree Î²</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>BST t</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Tree.find<span class="bp">?</span> (Tree.insert t k v) k <span class="bp">=</span> some v</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"> </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk37" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk37"><div class="alectryon-token"><span class="k">simp</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Goals accomplished<span class="bp">!</span> <span class="bp">ğŸ™</span></div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
  </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk38" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk38"><div class="alectryon-token"><span class="bp">|</span> node left key value right ihl ihr <span class="bp">=&gt;</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>BinTree Î²</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>left</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>key</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>right</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>ihl</var><span class="hyp-type"><b>: </b><span>BST left <span class="bp">â†’</span> Tree.find<span class="bp">?</span> (Tree.insert left k v) k <span class="bp">=</span> some v</span></span></span><br><span><var>ihr</var><span class="hyp-type"><b>: </b><span>BST right <span class="bp">â†’</span> Tree.find<span class="bp">?</span> (Tree.insert right k v) k <span class="bp">=</span> some v</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>BST (Tree.node left key value right)</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">node</span></span><div class="goal-conclusion">Tree.find<span class="bp">?</span>
    (<span class="k">if</span> k <span class="bp">&lt;</span> key <span class="k">then</span> Tree.node (Tree.insert left k v) key value right
    <span class="k">else</span> <span class="k">if</span> key <span class="bp">&lt;</span> k <span class="k">then</span> Tree.node left key value (Tree.insert right k v) <span class="k">else</span> Tree.node left k v right)
    k <span class="bp">=</span>
  some v</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
    </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk39" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk39"><div class="alectryon-token"><span class="k">by_cases&#39;</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div><div class="alectryon-token"> <span class="bp">&lt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>key</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">key</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>BinTree Î²</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>left</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>key</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>right</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>ihl</var><span class="hyp-type"><b>: </b><span>BST left <span class="bp">â†’</span> Tree.find<span class="bp">?</span> (Tree.insert left k v) k <span class="bp">=</span> some v</span></span></span><br><span><var>ihr</var><span class="hyp-type"><b>: </b><span>BST right <span class="bp">â†’</span> Tree.find<span class="bp">?</span> (Tree.insert right k v) k <span class="bp">=</span> some v</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>BST (Tree.node left key value right)</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">node.inl</span></span><div class="goal-conclusion">Tree.find<span class="bp">?</span> (Tree.insert left k v) k <span class="bp">=</span> some v</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk3a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>BinTree Î²</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>left</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>key</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>right</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>ihl</var><span class="hyp-type"><b>: </b><span>BST left <span class="bp">â†’</span> Tree.find<span class="bp">?</span> (Tree.insert left k v) k <span class="bp">=</span> some v</span></span></span><br><span><var>ihr</var><span class="hyp-type"><b>: </b><span>BST right <span class="bp">â†’</span> Tree.find<span class="bp">?</span> (Tree.insert right k v) k <span class="bp">=</span> some v</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>BST (Tree.node left key value right)</span></span></span><br></div><label class="goal-separator" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk3a"><hr><span class="goal-name">node.inr</span></label><div class="goal-conclusion">Tree.find<span class="bp">?</span> (<span class="k">if</span> key <span class="bp">&lt;</span> k <span class="k">then</span> Tree.node left key value (Tree.insert right k v) <span class="k">else</span> Tree.node left k v right) k <span class="bp">=</span> some v</div></blockquote></div></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
    </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk3b" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk3b"><div class="alectryon-token"><span class="bp">.</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>BinTree Î²</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>left</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>key</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>right</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>ihl</var><span class="hyp-type"><b>: </b><span>BST left <span class="bp">â†’</span> Tree.find<span class="bp">?</span> (Tree.insert left k v) k <span class="bp">=</span> some v</span></span></span><br><span><var>ihr</var><span class="hyp-type"><b>: </b><span>BST right <span class="bp">â†’</span> Tree.find<span class="bp">?</span> (Tree.insert right k v) k <span class="bp">=</span> some v</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>BST (Tree.node left key value right)</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">node.inl</span></span><div class="goal-conclusion">Tree.find<span class="bp">?</span> (Tree.insert left k v) k <span class="bp">=</span> some v</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"> </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk3c" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk3c"><div class="alectryon-token"><span class="k">cases</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h</var><b>: </b><span>BST (Tree.node left key value right)</span></span></div></blockquote></div></small></div><span class="nv">h</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>BinTree Î²</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>left</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>key</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>right</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>ihl</var><span class="hyp-type"><b>: </b><span>BST left <span class="bp">â†’</span> Tree.find<span class="bp">?</span> (Tree.insert left k v) k <span class="bp">=</span> some v</span></span></span><br><span><var>ihr</var><span class="hyp-type"><b>: </b><span>BST right <span class="bp">â†’</span> Tree.find<span class="bp">?</span> (Tree.insert right k v) k <span class="bp">=</span> some v</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">node.inl.node</span></span><div class="goal-conclusion">Tree.find<span class="bp">?</span> (Tree.insert left k v) k <span class="bp">=</span> some v</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"><span class="bp">;</span> </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk3d" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk3d"><div class="alectryon-token"><span class="k">apply</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ihl</var><b>: </b><span>BST left â†’ Tree.find? (Tree.insert left k v) k = some v</span></span></div></blockquote></div></small></div><span class="nv">ihl</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>BinTree Î²</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>left</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>key</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>right</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>ihl</var><span class="hyp-type"><b>: </b><span>BST left <span class="bp">â†’</span> Tree.find<span class="bp">?</span> (Tree.insert left k v) k <span class="bp">=</span> some v</span></span></span><br><span><var>ihr</var><span class="hyp-type"><b>: </b><span>BST right <span class="bp">â†’</span> Tree.find<span class="bp">?</span> (Tree.insert right k v) k <span class="bp">=</span> some v</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">node.inl.node</span></span><div class="goal-conclusion">BST left</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"><span class="bp">;</span> </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk3e" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk3e"><div class="alectryon-token"><span class="k">assumption</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Goals accomplished<span class="bp">!</span> <span class="bp">ğŸ™</span></div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
    </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk3f" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk3f"><div class="alectryon-token"><span class="bp">.</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>BinTree Î²</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>left</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>key</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>right</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>ihl</var><span class="hyp-type"><b>: </b><span>BST left <span class="bp">â†’</span> Tree.find<span class="bp">?</span> (Tree.insert left k v) k <span class="bp">=</span> some v</span></span></span><br><span><var>ihr</var><span class="hyp-type"><b>: </b><span>BST right <span class="bp">â†’</span> Tree.find<span class="bp">?</span> (Tree.insert right k v) k <span class="bp">=</span> some v</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>BST (Tree.node left key value right)</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">node.inr</span></span><div class="goal-conclusion">Tree.find<span class="bp">?</span> (<span class="k">if</span> key <span class="bp">&lt;</span> k <span class="k">then</span> Tree.node left key value (Tree.insert right k v) <span class="k">else</span> Tree.node left k v right) k <span class="bp">=</span> some v</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"> </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk40" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk40"><div class="alectryon-token"><span class="k">by_cases&#39;</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>key</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">key</span></div><div class="alectryon-token"> <span class="bp">&lt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>BinTree Î²</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>left</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>key</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>right</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>ihl</var><span class="hyp-type"><b>: </b><span>BST left <span class="bp">â†’</span> Tree.find<span class="bp">?</span> (Tree.insert left k v) k <span class="bp">=</span> some v</span></span></span><br><span><var>ihr</var><span class="hyp-type"><b>: </b><span>BST right <span class="bp">â†’</span> Tree.find<span class="bp">?</span> (Tree.insert right k v) k <span class="bp">=</span> some v</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>BST (Tree.node left key value right)</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">node.inr.inl</span></span><div class="goal-conclusion">Tree.find<span class="bp">?</span> (Tree.insert right k v) k <span class="bp">=</span> some v</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
      </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk41" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk41"><div class="alectryon-token"><span class="k">cases</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h</var><b>: </b><span>BST (Tree.node left key value right)</span></span></div></blockquote></div></small></div><span class="nv">h</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>BinTree Î²</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>left</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>key</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>right</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>ihl</var><span class="hyp-type"><b>: </b><span>BST left <span class="bp">â†’</span> Tree.find<span class="bp">?</span> (Tree.insert left k v) k <span class="bp">=</span> some v</span></span></span><br><span><var>ihr</var><span class="hyp-type"><b>: </b><span>BST right <span class="bp">â†’</span> Tree.find<span class="bp">?</span> (Tree.insert right k v) k <span class="bp">=</span> some v</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">node.inr.inl.node</span></span><div class="goal-conclusion">Tree.find<span class="bp">?</span> (Tree.insert right k v) k <span class="bp">=</span> some v</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"><span class="bp">;</span> </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk42" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk42"><div class="alectryon-token"><span class="k">apply</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ihr</var><b>: </b><span>BST right â†’ Tree.find? (Tree.insert right k v) k = some v</span></span></div></blockquote></div></small></div><span class="nv">ihr</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>BinTree Î²</span></span></span><br><span><var>k</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>left</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>key</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>right</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>ihl</var><span class="hyp-type"><b>: </b><span>BST left <span class="bp">â†’</span> Tree.find<span class="bp">?</span> (Tree.insert left k v) k <span class="bp">=</span> some v</span></span></span><br><span><var>ihr</var><span class="hyp-type"><b>: </b><span>BST right <span class="bp">â†’</span> Tree.find<span class="bp">?</span> (Tree.insert right k v) k <span class="bp">=</span> some v</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">node.inr.inl.node</span></span><div class="goal-conclusion">BST right</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"><span class="bp">;</span> </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk43" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk43"><div class="alectryon-token"><span class="k">assumption</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Goals accomplished<span class="bp">!</span> <span class="bp">ğŸ™</span></div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">

</div><div class="alectryon-token"><span class="kd">theorem</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>BinTree.find_insert_of_ne</var><b>: </b><span>âˆ€ {Î² : Type u_1} {k k' : Nat} (b : BinTree Î²), k â‰  k' â†’ âˆ€ (v : Î²), find? (insert b k v) k' = find? b k'</span></span></div></blockquote></div></small></div>BinTree.find_insert_of_ne</div><div class="alectryon-token"> (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b</var><b>: </b><span>BinTree Î²</span></span></div></blockquote></div></small></div><span class="nv">b</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>BinTree</var><b>: </b><span>Type ?u.14926 â†’ Type ?u.14926</span></span></div></blockquote></div></small></div>BinTree</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Î²</var><b>: </b><span>Type u_1</span></span></div></blockquote></div></small></div><span class="nv">Î²</span></div><div class="alectryon-token">) (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h</var><b>: </b><span>k â‰  k'</span></span></div></blockquote></div></small></div><span class="nv">h</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div><div class="alectryon-token"> <span class="bp">â‰ </span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k'</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k&#39;</span></div><div class="alectryon-token">) (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>v</var><b>: </b><span>Î²</span></span></div></blockquote></div></small></div><span class="nv">v</span></div><div class="alectryon-token"> : </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>Î²</var><b>: </b><span>Type u_1</span></span></div></blockquote></div></small></div><span class="nv">Î²</span></div><div class="alectryon-token">)
        : (</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b</var><b>: </b><span>BinTree Î²</span></span></div></blockquote></div></small></div><span class="nv">b</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>insert</var><b>: </b><span>{Î² : Type u_1} â†’ BinTree Î² â†’ Nat â†’ Î² â†’ BinTree Î²</span></span></div></blockquote></div></small></div>insert</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>v</var><b>: </b><span>Î²</span></span></div></blockquote></div></small></div><span class="nv">v</span></div><div class="alectryon-token">)<span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>find?</var><b>: </b><span>{Î² : Type u_1} â†’ BinTree Î² â†’ Nat â†’ Option Î²</span></span></div></blockquote></div></small></div>find<span class="bp">?</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k'</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k&#39;</span></div><div class="alectryon-token"> <span class="bp">=</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b</var><b>: </b><span>BinTree Î²</span></span></div></blockquote></div></small></div><span class="nv">b</span></div><div class="alectryon-token"><span class="bp">.</span></div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>find?</var><b>: </b><span>{Î² : Type u_1} â†’ BinTree Î² â†’ Nat â†’ Option Î²</span></span></div></blockquote></div></small></div>find<span class="bp">?</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k'</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k&#39;</span></div><div class="alectryon-token"> := </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk44" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk44"><div class="alectryon-token"><span class="kd">by</span></div><div class="alectryon-token"></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>k, k'</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>BinTree Î²</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>k <span class="bp">â‰ </span> k&#39;</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">find<span class="bp">?</span> (insert b k v) k&#39; <span class="bp">=</span> find<span class="bp">?</span> b k&#39;</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
  </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk45" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk45"><div class="alectryon-token"><span class="k">let</span></div><div class="alectryon-token"> âŸ¨</div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">t</span></div><div class="alectryon-token">, </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h</var><b>: </b><span>k â‰  k'</span></span></div></blockquote></div></small></div><span class="nv">h</span></div><div class="alectryon-token">âŸ© := </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>b</var><b>: </b><span>BinTree Î²</span></span></div></blockquote></div></small></div><span class="nv">b</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>k, k'</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>BinTree Î²</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>BST t</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">find<span class="bp">?</span> (insert { val := t, property := h } k v) k&#39; <span class="bp">=</span> find<span class="bp">?</span> { val := t, property := h } k&#39;</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"><span class="bp">;</span></div><div class="alectryon-token"> </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk46" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk46"><div class="alectryon-token"><span class="k">simp</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>k, k'</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>BinTree Î²</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>BST t</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Tree.find<span class="bp">?</span> (Tree.insert t k v) k&#39; <span class="bp">=</span> Tree.find<span class="bp">?</span> t k&#39;</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
  </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk47" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk47"><div class="alectryon-token"><span class="k">induction</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>t</var><b>: </b><span>Tree Î²</span></span></div></blockquote></div></small></div><span class="nv">t</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><span class="k">with</span></div><div class="alectryon-token"></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>k, k'</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>BinTree Î²</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>t</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>BST t</span></span></span><br></div><span class="goal-separator"><hr></span><div class="goal-conclusion">Tree.find<span class="bp">?</span> (Tree.insert t k v) k&#39; <span class="bp">=</span> Tree.find<span class="bp">?</span> t k&#39;</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"> </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk48" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk48"><div class="alectryon-token"><span class="k">simp</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>k, k'</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>BinTree Î²</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>left</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>key</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>right</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>ihl</var><span class="hyp-type"><b>: </b><span>BST left <span class="bp">â†’</span> Tree.find<span class="bp">?</span> (Tree.insert left k v) k&#39; <span class="bp">=</span> Tree.find<span class="bp">?</span> left k&#39;</span></span></span><br><span><var>ihr</var><span class="hyp-type"><b>: </b><span>BST right <span class="bp">â†’</span> Tree.find<span class="bp">?</span> (Tree.insert right k v) k&#39; <span class="bp">=</span> Tree.find<span class="bp">?</span> right k&#39;</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>BST (Tree.node left key value right)</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">node</span></span><div class="goal-conclusion">Tree.find<span class="bp">?</span>
    (<span class="k">if</span> k <span class="bp">&lt;</span> key <span class="k">then</span> Tree.node (Tree.insert left k v) key value right
    <span class="k">else</span> <span class="k">if</span> key <span class="bp">&lt;</span> k <span class="k">then</span> Tree.node left key value (Tree.insert right k v) <span class="k">else</span> Tree.node left k v right)
    k&#39; <span class="bp">=</span>
  <span class="k">if</span> k&#39; <span class="bp">&lt;</span> key <span class="k">then</span> Tree.find<span class="bp">?</span> left k&#39; <span class="k">else</span> <span class="k">if</span> key <span class="bp">&lt;</span> k&#39; <span class="k">then</span> Tree.find<span class="bp">?</span> right k&#39; <span class="k">else</span> some value</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
  </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk49" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk49"><div class="alectryon-token"><span class="bp">|</span> leaf <span class="bp">=&gt;</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>k, k'</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>BinTree Î²</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>BST Tree.leaf</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">leaf</span></span><div class="goal-conclusion">(<span class="k">if</span> k&#39; <span class="bp">&lt;</span> k <span class="k">then</span> none <span class="k">else</span> <span class="k">if</span> k <span class="bp">&lt;</span> k&#39; <span class="k">then</span> none <span class="k">else</span> some v) <span class="bp">=</span> none</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
    </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk4a" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk4a"><div class="alectryon-token"><span class="k">split</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>k, k'</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>BinTree Î²</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>BST Tree.leaf</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">leaf.inl</span></span><div class="goal-conclusion">none <span class="bp">=</span> none</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk4b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>k, k'</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>BinTree Î²</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>BST Tree.leaf</span></span></span><br></div><label class="goal-separator" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk4b"><hr><span class="goal-name">leaf.inr</span></label><div class="goal-conclusion">(<span class="k">if</span> k <span class="bp">&lt;</span> k&#39; <span class="k">then</span> none <span class="k">else</span> some v) <span class="bp">=</span> none</div></blockquote></div></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"> </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk4c" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk4c"><div class="alectryon-token"><span class="k">&lt;;&gt;</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>k, k'</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>BinTree Î²</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>BST Tree.leaf</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">leaf</span></span><div class="goal-conclusion">(<span class="k">if</span> k&#39; <span class="bp">&lt;</span> k <span class="k">then</span> none <span class="k">else</span> <span class="k">if</span> k <span class="bp">&lt;</span> k&#39; <span class="k">then</span> none <span class="k">else</span> some v) <span class="bp">=</span> none</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"> </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk4d" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk4d"><div class="alectryon-token"><span class="k">simp</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>k, k'</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>BinTree Î²</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>BST Tree.leaf</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">leaf.inr</span></span><div class="goal-conclusion">(<span class="k">if</span> k <span class="bp">&lt;</span> k&#39; <span class="k">then</span> none <span class="k">else</span> some v) <span class="bp">=</span> none</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"> </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk4e" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk4e"><div class="alectryon-token"><span class="k">&lt;;&gt;</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>k, k'</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>BinTree Î²</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>BST Tree.leaf</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">leaf.inl</span></span><div class="goal-conclusion">none <span class="bp">=</span> none</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"> </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk4f" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk4f"><div class="alectryon-token"><span class="k">split</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>k, k'</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>BinTree Î²</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>BST Tree.leaf</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">leaf.inr.inl</span></span><div class="goal-conclusion">none <span class="bp">=</span> none</div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk50" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>k, k'</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>BinTree Î²</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>BST Tree.leaf</span></span></span><br></div><label class="goal-separator" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk50"><hr><span class="goal-name">leaf.inr.inr</span></label><div class="goal-conclusion">False</div></blockquote></div></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"> </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk51" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk51"><div class="alectryon-token"><span class="k">&lt;;&gt;</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>k, k'</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>BinTree Î²</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>BST Tree.leaf</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">leaf.inr</span></span><div class="goal-conclusion">(<span class="k">if</span> k <span class="bp">&lt;</span> k&#39; <span class="k">then</span> none <span class="k">else</span> some v) <span class="bp">=</span> none</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"> </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk52" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk52"><div class="alectryon-token"><span class="k">simp</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Goals accomplished<span class="bp">!</span> <span class="bp">ğŸ™</span></div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
    </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk53" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk53"><div class="alectryon-token"><span class="k">have_eq</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k'</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k&#39;</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>k'</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>BinTree Î²</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>k&#39; <span class="bp">â‰ </span> k&#39;</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">leaf.inr.inr</span></span><div class="goal-conclusion">False</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
    </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk54" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk54"><div class="alectryon-token"><span class="k">contradiction</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Goals accomplished<span class="bp">!</span> <span class="bp">ğŸ™</span></div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
  </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk55" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk55"><div class="alectryon-token"><span class="bp">|</span> node left key value right ihl ihr <span class="bp">=&gt;</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>k, k'</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>BinTree Î²</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>left</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>key</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>right</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>ihl</var><span class="hyp-type"><b>: </b><span>BST left <span class="bp">â†’</span> Tree.find<span class="bp">?</span> (Tree.insert left k v) k&#39; <span class="bp">=</span> Tree.find<span class="bp">?</span> left k&#39;</span></span></span><br><span><var>ihr</var><span class="hyp-type"><b>: </b><span>BST right <span class="bp">â†’</span> Tree.find<span class="bp">?</span> (Tree.insert right k v) k&#39; <span class="bp">=</span> Tree.find<span class="bp">?</span> right k&#39;</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>BST (Tree.node left key value right)</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">node</span></span><div class="goal-conclusion">Tree.find<span class="bp">?</span>
    (<span class="k">if</span> k <span class="bp">&lt;</span> key <span class="k">then</span> Tree.node (Tree.insert left k v) key value right
    <span class="k">else</span> <span class="k">if</span> key <span class="bp">&lt;</span> k <span class="k">then</span> Tree.node left key value (Tree.insert right k v) <span class="k">else</span> Tree.node left k v right)
    k&#39; <span class="bp">=</span>
  <span class="k">if</span> k&#39; <span class="bp">&lt;</span> key <span class="k">then</span> Tree.find<span class="bp">?</span> left k&#39; <span class="k">else</span> <span class="k">if</span> key <span class="bp">&lt;</span> k&#39; <span class="k">then</span> Tree.find<span class="bp">?</span> right k&#39; <span class="k">else</span> some value</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
    </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk56" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk56"><div class="alectryon-token"><span class="k">let</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>.node</var><b>: </b><span>âˆ€ {Î² : Type u_1} {key : Nat} {left right : Tree Î²} {value : Î²},
  ForallTree (fun k v =&gt; k &lt; key) left â†’
    ForallTree (fun k v =&gt; key &lt; k) right â†’ BST left â†’ BST right â†’ BST (Tree.node left key value right)</span></span></div></blockquote></div></small></div><span class="bp">.</span>node</div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>hl</var><b>: </b><span>ForallTree (fun k v =&gt; k &lt; key) left</span></span></div></blockquote></div></small></div><span class="nv">hl</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>hr</var><b>: </b><span>ForallTree (fun k v =&gt; key &lt; k) right</span></span></div></blockquote></div></small></div><span class="nv">hr</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>bl</var><b>: </b><span>BST left</span></span></div></blockquote></div></small></div><span class="nv">bl</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>br</var><b>: </b><span>BST right</span></span></div></blockquote></div></small></div><span class="nv">br</span></div><div class="alectryon-token"> := </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>h</var><b>: </b><span>BST (Tree.node left key value right)</span></span></div></blockquote></div></small></div><span class="nv">h</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>k, k'</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>BinTree Î²</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>left</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>key</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>right</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>ihl</var><span class="hyp-type"><b>: </b><span>BST left <span class="bp">â†’</span> Tree.find<span class="bp">?</span> (Tree.insert left k v) k&#39; <span class="bp">=</span> Tree.find<span class="bp">?</span> left k&#39;</span></span></span><br><span><var>ihr</var><span class="hyp-type"><b>: </b><span>BST right <span class="bp">â†’</span> Tree.find<span class="bp">?</span> (Tree.insert right k v) k&#39; <span class="bp">=</span> Tree.find<span class="bp">?</span> right k&#39;</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>BST (Tree.node left key value right)</span></span></span><br><span><var>hl</var><span class="hyp-type"><b>: </b><span>ForallTree (<span class="k">fun</span> k v <span class="bp">=&gt;</span> k <span class="bp">&lt;</span> key) left</span></span></span><br><span><var>hr</var><span class="hyp-type"><b>: </b><span>ForallTree (<span class="k">fun</span> k v <span class="bp">=&gt;</span> key <span class="bp">&lt;</span> k) right</span></span></span><br><span><var>bl</var><span class="hyp-type"><b>: </b><span>BST left</span></span></span><br><span><var>br</var><span class="hyp-type"><b>: </b><span>BST right</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">node</span></span><div class="goal-conclusion">Tree.find<span class="bp">?</span>
    (<span class="k">if</span> k <span class="bp">&lt;</span> key <span class="k">then</span> Tree.node (Tree.insert left k v) key value right
    <span class="k">else</span> <span class="k">if</span> key <span class="bp">&lt;</span> k <span class="k">then</span> Tree.node left key value (Tree.insert right k v) <span class="k">else</span> Tree.node left k v right)
    k&#39; <span class="bp">=</span>
  <span class="k">if</span> k&#39; <span class="bp">&lt;</span> key <span class="k">then</span> Tree.find<span class="bp">?</span> left k&#39; <span class="k">else</span> <span class="k">if</span> key <span class="bp">&lt;</span> k&#39; <span class="k">then</span> Tree.find<span class="bp">?</span> right k&#39; <span class="k">else</span> some value</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
    </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk57" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk57"><div class="alectryon-token"><span class="k">specialize</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ihl</var><b>: </b><span>BST left â†’ Tree.find? (Tree.insert left k v) k' = Tree.find? left k'</span></span></div></blockquote></div></small></div><span class="nv">ihl</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>bl</var><b>: </b><span>BST left</span></span></div></blockquote></div></small></div><span class="nv">bl</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>k, k'</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>BinTree Î²</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>left</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>key</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>right</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>ihr</var><span class="hyp-type"><b>: </b><span>BST right <span class="bp">â†’</span> Tree.find<span class="bp">?</span> (Tree.insert right k v) k&#39; <span class="bp">=</span> Tree.find<span class="bp">?</span> right k&#39;</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>BST (Tree.node left key value right)</span></span></span><br><span><var>hl</var><span class="hyp-type"><b>: </b><span>ForallTree (<span class="k">fun</span> k v <span class="bp">=&gt;</span> k <span class="bp">&lt;</span> key) left</span></span></span><br><span><var>hr</var><span class="hyp-type"><b>: </b><span>ForallTree (<span class="k">fun</span> k v <span class="bp">=&gt;</span> key <span class="bp">&lt;</span> k) right</span></span></span><br><span><var>bl</var><span class="hyp-type"><b>: </b><span>BST left</span></span></span><br><span><var>br</var><span class="hyp-type"><b>: </b><span>BST right</span></span></span><br><span><var>ihl</var><span class="hyp-type"><b>: </b><span>Tree.find<span class="bp">?</span> (Tree.insert left k v) k&#39; <span class="bp">=</span> Tree.find<span class="bp">?</span> left k&#39;</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">node</span></span><div class="goal-conclusion">Tree.find<span class="bp">?</span>
    (<span class="k">if</span> k <span class="bp">&lt;</span> key <span class="k">then</span> Tree.node (Tree.insert left k v) key value right
    <span class="k">else</span> <span class="k">if</span> key <span class="bp">&lt;</span> k <span class="k">then</span> Tree.node left key value (Tree.insert right k v) <span class="k">else</span> Tree.node left k v right)
    k&#39; <span class="bp">=</span>
  <span class="k">if</span> k&#39; <span class="bp">&lt;</span> key <span class="k">then</span> Tree.find<span class="bp">?</span> left k&#39; <span class="k">else</span> <span class="k">if</span> key <span class="bp">&lt;</span> k&#39; <span class="k">then</span> Tree.find<span class="bp">?</span> right k&#39; <span class="k">else</span> some value</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
    </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk58" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk58"><div class="alectryon-token"><span class="k">specialize</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>ihr</var><b>: </b><span>BST right â†’ Tree.find? (Tree.insert right k v) k' = Tree.find? right k'</span></span></div></blockquote></div></small></div><span class="nv">ihr</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>br</var><b>: </b><span>BST right</span></span></div></blockquote></div></small></div><span class="nv">br</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>k, k'</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>BinTree Î²</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>left</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>key</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>right</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>BST (Tree.node left key value right)</span></span></span><br><span><var>hl</var><span class="hyp-type"><b>: </b><span>ForallTree (<span class="k">fun</span> k v <span class="bp">=&gt;</span> k <span class="bp">&lt;</span> key) left</span></span></span><br><span><var>hr</var><span class="hyp-type"><b>: </b><span>ForallTree (<span class="k">fun</span> k v <span class="bp">=&gt;</span> key <span class="bp">&lt;</span> k) right</span></span></span><br><span><var>bl</var><span class="hyp-type"><b>: </b><span>BST left</span></span></span><br><span><var>br</var><span class="hyp-type"><b>: </b><span>BST right</span></span></span><br><span><var>ihl</var><span class="hyp-type"><b>: </b><span>Tree.find<span class="bp">?</span> (Tree.insert left k v) k&#39; <span class="bp">=</span> Tree.find<span class="bp">?</span> left k&#39;</span></span></span><br><span><var>ihr</var><span class="hyp-type"><b>: </b><span>Tree.find<span class="bp">?</span> (Tree.insert right k v) k&#39; <span class="bp">=</span> Tree.find<span class="bp">?</span> right k&#39;</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">node</span></span><div class="goal-conclusion">Tree.find<span class="bp">?</span>
    (<span class="k">if</span> k <span class="bp">&lt;</span> key <span class="k">then</span> Tree.node (Tree.insert left k v) key value right
    <span class="k">else</span> <span class="k">if</span> key <span class="bp">&lt;</span> k <span class="k">then</span> Tree.node left key value (Tree.insert right k v) <span class="k">else</span> Tree.node left k v right)
    k&#39; <span class="bp">=</span>
  <span class="k">if</span> k&#39; <span class="bp">&lt;</span> key <span class="k">then</span> Tree.find<span class="bp">?</span> left k&#39; <span class="k">else</span> <span class="k">if</span> key <span class="bp">&lt;</span> k&#39; <span class="k">then</span> Tree.find<span class="bp">?</span> right k&#39; <span class="k">else</span> some value</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
    </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk59" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk59"><div class="alectryon-token"><span class="k">by_cases&#39;</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div><div class="alectryon-token"> <span class="bp">&lt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>key</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">key</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>k, k'</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>BinTree Î²</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>left</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>key</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>right</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>BST (Tree.node left key value right)</span></span></span><br><span><var>hl</var><span class="hyp-type"><b>: </b><span>ForallTree (<span class="k">fun</span> k v <span class="bp">=&gt;</span> k <span class="bp">&lt;</span> key) left</span></span></span><br><span><var>hr</var><span class="hyp-type"><b>: </b><span>ForallTree (<span class="k">fun</span> k v <span class="bp">=&gt;</span> key <span class="bp">&lt;</span> k) right</span></span></span><br><span><var>bl</var><span class="hyp-type"><b>: </b><span>BST left</span></span></span><br><span><var>br</var><span class="hyp-type"><b>: </b><span>BST right</span></span></span><br><span><var>ihl</var><span class="hyp-type"><b>: </b><span>Tree.find<span class="bp">?</span> (Tree.insert left k v) k&#39; <span class="bp">=</span> Tree.find<span class="bp">?</span> left k&#39;</span></span></span><br><span><var>ihr</var><span class="hyp-type"><b>: </b><span>Tree.find<span class="bp">?</span> (Tree.insert right k v) k&#39; <span class="bp">=</span> Tree.find<span class="bp">?</span> right k&#39;</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">node.inr</span></span><div class="goal-conclusion">Tree.find<span class="bp">?</span> (<span class="k">if</span> key <span class="bp">&lt;</span> k <span class="k">then</span> Tree.node left key value (Tree.insert right k v) <span class="k">else</span> Tree.node left k v right) k&#39; <span class="bp">=</span>
  <span class="k">if</span> k&#39; <span class="bp">&lt;</span> key <span class="k">then</span> Tree.find<span class="bp">?</span> left k&#39; <span class="k">else</span> <span class="k">if</span> key <span class="bp">&lt;</span> k&#39; <span class="k">then</span> Tree.find<span class="bp">?</span> right k&#39; <span class="k">else</span> some value</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"><span class="bp">;</span></div><div class="alectryon-token"> </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk5a" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk5a"><div class="alectryon-token"><span class="k">by_cases&#39;</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>key</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">key</span></div><div class="alectryon-token"> <span class="bp">&lt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>k, k'</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>BinTree Î²</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>left</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>key</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>right</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>BST (Tree.node left key value right)</span></span></span><br><span><var>hl</var><span class="hyp-type"><b>: </b><span>ForallTree (<span class="k">fun</span> k v <span class="bp">=&gt;</span> k <span class="bp">&lt;</span> key) left</span></span></span><br><span><var>hr</var><span class="hyp-type"><b>: </b><span>ForallTree (<span class="k">fun</span> k v <span class="bp">=&gt;</span> key <span class="bp">&lt;</span> k) right</span></span></span><br><span><var>bl</var><span class="hyp-type"><b>: </b><span>BST left</span></span></span><br><span><var>br</var><span class="hyp-type"><b>: </b><span>BST right</span></span></span><br><span><var>ihl</var><span class="hyp-type"><b>: </b><span>Tree.find<span class="bp">?</span> (Tree.insert left k v) k&#39; <span class="bp">=</span> Tree.find<span class="bp">?</span> left k&#39;</span></span></span><br><span><var>ihr</var><span class="hyp-type"><b>: </b><span>Tree.find<span class="bp">?</span> (Tree.insert right k v) k&#39; <span class="bp">=</span> Tree.find<span class="bp">?</span> right k&#39;</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">node.inr.inr</span></span><div class="goal-conclusion">(<span class="k">if</span> k&#39; <span class="bp">&lt;</span> k <span class="k">then</span> Tree.find<span class="bp">?</span> left k&#39; <span class="k">else</span> <span class="k">if</span> k <span class="bp">&lt;</span> k&#39; <span class="k">then</span> Tree.find<span class="bp">?</span> right k&#39; <span class="k">else</span> some v) <span class="bp">=</span>
  <span class="k">if</span> k&#39; <span class="bp">&lt;</span> key <span class="k">then</span> Tree.find<span class="bp">?</span> left k&#39; <span class="k">else</span> <span class="k">if</span> key <span class="bp">&lt;</span> k&#39; <span class="k">then</span> Tree.find<span class="bp">?</span> right k&#39; <span class="k">else</span> some value</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
    </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk5b" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk5b"><div class="alectryon-token"><span class="k">have_eq</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>key</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">key</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>k, k'</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>BinTree Î²</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>left</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>right</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>bl</var><span class="hyp-type"><b>: </b><span>BST left</span></span></span><br><span><var>br</var><span class="hyp-type"><b>: </b><span>BST right</span></span></span><br><span><var>ihl</var><span class="hyp-type"><b>: </b><span>Tree.find<span class="bp">?</span> (Tree.insert left k v) k&#39; <span class="bp">=</span> Tree.find<span class="bp">?</span> left k&#39;</span></span></span><br><span><var>ihr</var><span class="hyp-type"><b>: </b><span>Tree.find<span class="bp">?</span> (Tree.insert right k v) k&#39; <span class="bp">=</span> Tree.find<span class="bp">?</span> right k&#39;</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>BST (Tree.node left k value right)</span></span></span><br><span><var>hl</var><span class="hyp-type"><b>: </b><span>ForallTree (<span class="k">fun</span> k_1 v <span class="bp">=&gt;</span> k_1 <span class="bp">&lt;</span> k) left</span></span></span><br><span><var>hr</var><span class="hyp-type"><b>: </b><span>ForallTree (<span class="k">fun</span> k_1 v <span class="bp">=&gt;</span> k <span class="bp">&lt;</span> k_1) right</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">node.inr.inr</span></span><div class="goal-conclusion">(<span class="k">if</span> k&#39; <span class="bp">&lt;</span> k <span class="k">then</span> Tree.find<span class="bp">?</span> left k&#39; <span class="k">else</span> <span class="k">if</span> k <span class="bp">&lt;</span> k&#39; <span class="k">then</span> Tree.find<span class="bp">?</span> right k&#39; <span class="k">else</span> some v) <span class="bp">=</span>
  <span class="k">if</span> k&#39; <span class="bp">&lt;</span> k <span class="k">then</span> Tree.find<span class="bp">?</span> left k&#39; <span class="k">else</span> <span class="k">if</span> k <span class="bp">&lt;</span> k&#39; <span class="k">then</span> Tree.find<span class="bp">?</span> right k&#39; <span class="k">else</span> some value</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
    </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk5c" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk5c"><div class="alectryon-token"><span class="k">by_cases&#39;</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k'</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k&#39;</span></div><div class="alectryon-token"> <span class="bp">&lt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>k, k'</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>BinTree Î²</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>left</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>right</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>bl</var><span class="hyp-type"><b>: </b><span>BST left</span></span></span><br><span><var>br</var><span class="hyp-type"><b>: </b><span>BST right</span></span></span><br><span><var>ihl</var><span class="hyp-type"><b>: </b><span>Tree.find<span class="bp">?</span> (Tree.insert left k v) k&#39; <span class="bp">=</span> Tree.find<span class="bp">?</span> left k&#39;</span></span></span><br><span><var>ihr</var><span class="hyp-type"><b>: </b><span>Tree.find<span class="bp">?</span> (Tree.insert right k v) k&#39; <span class="bp">=</span> Tree.find<span class="bp">?</span> right k&#39;</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>BST (Tree.node left k value right)</span></span></span><br><span><var>hl</var><span class="hyp-type"><b>: </b><span>ForallTree (<span class="k">fun</span> k_1 v <span class="bp">=&gt;</span> k_1 <span class="bp">&lt;</span> k) left</span></span></span><br><span><var>hr</var><span class="hyp-type"><b>: </b><span>ForallTree (<span class="k">fun</span> k_1 v <span class="bp">=&gt;</span> k <span class="bp">&lt;</span> k_1) right</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">node.inr.inr.inr</span></span><div class="goal-conclusion">(<span class="k">if</span> k <span class="bp">&lt;</span> k&#39; <span class="k">then</span> Tree.find<span class="bp">?</span> right k&#39; <span class="k">else</span> some v) <span class="bp">=</span> <span class="k">if</span> k <span class="bp">&lt;</span> k&#39; <span class="k">then</span> Tree.find<span class="bp">?</span> right k&#39; <span class="k">else</span> some value</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token"><span class="bp">;</span></div><div class="alectryon-token"> </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk5d" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk5d"><div class="alectryon-token"><span class="k">by_cases&#39;</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div><div class="alectryon-token">  <span class="bp">&lt;</span> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k'</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k&#39;</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>k, k'</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>BinTree Î²</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>left</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>right</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>bl</var><span class="hyp-type"><b>: </b><span>BST left</span></span></span><br><span><var>br</var><span class="hyp-type"><b>: </b><span>BST right</span></span></span><br><span><var>ihl</var><span class="hyp-type"><b>: </b><span>Tree.find<span class="bp">?</span> (Tree.insert left k v) k&#39; <span class="bp">=</span> Tree.find<span class="bp">?</span> left k&#39;</span></span></span><br><span><var>ihr</var><span class="hyp-type"><b>: </b><span>Tree.find<span class="bp">?</span> (Tree.insert right k v) k&#39; <span class="bp">=</span> Tree.find<span class="bp">?</span> right k&#39;</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>BST (Tree.node left k value right)</span></span></span><br><span><var>hl</var><span class="hyp-type"><b>: </b><span>ForallTree (<span class="k">fun</span> k_1 v <span class="bp">=&gt;</span> k_1 <span class="bp">&lt;</span> k) left</span></span></span><br><span><var>hr</var><span class="hyp-type"><b>: </b><span>ForallTree (<span class="k">fun</span> k_1 v <span class="bp">=&gt;</span> k <span class="bp">&lt;</span> k_1) right</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">node.inr.inr.inr.inr</span></span><div class="goal-conclusion">v <span class="bp">=</span> value</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
    </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk5e" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk5e"><div class="alectryon-token"><span class="k">have_eq</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k</span></div><div class="alectryon-token"> </div><div class="alectryon-token"><div class="alectryon-type-info-wrapper"><small class="alectryon-type-info"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span class="hyp-type"><var>k'</var><b>: </b><span>Nat</span></span></div></blockquote></div></small></div><span class="nv">k&#39;</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><span><var>Î²</var><span class="hyp-type"><b>: </b><span><span class="kt">Type</span> u_1</span></span></span><br><span><var>k'</var><span class="hyp-type"><b>: </b><span>Nat</span></span></span><br><span><var>b</var><span class="hyp-type"><b>: </b><span>BinTree Î²</span></span></span><br><span><var>v</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>left</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>value</var><span class="hyp-type"><b>: </b><span>Î²</span></span></span><br><span><var>right</var><span class="hyp-type"><b>: </b><span>Tree Î²</span></span></span><br><span><var>bl</var><span class="hyp-type"><b>: </b><span>BST left</span></span></span><br><span><var>br</var><span class="hyp-type"><b>: </b><span>BST right</span></span></span><br><span><var>ihl</var><span class="hyp-type"><b>: </b><span>Tree.find<span class="bp">?</span> (Tree.insert left k&#39; v) k&#39; <span class="bp">=</span> Tree.find<span class="bp">?</span> left k&#39;</span></span></span><br><span><var>ihr</var><span class="hyp-type"><b>: </b><span>Tree.find<span class="bp">?</span> (Tree.insert right k&#39; v) k&#39; <span class="bp">=</span> Tree.find<span class="bp">?</span> right k&#39;</span></span></span><br><span><var>h</var><span class="hyp-type"><b>: </b><span>BST (Tree.node left k&#39; value right)</span></span></span><br><span><var>hl</var><span class="hyp-type"><b>: </b><span>ForallTree (<span class="k">fun</span> k v <span class="bp">=&gt;</span> k <span class="bp">&lt;</span> k&#39;) left</span></span></span><br><span><var>hr</var><span class="hyp-type"><b>: </b><span>ForallTree (<span class="k">fun</span> k v <span class="bp">=&gt;</span> k&#39; <span class="bp">&lt;</span> k) right</span></span></span><br></div><span class="goal-separator"><hr><span class="goal-name">node.inr.inr.inr.inr</span></span><div class="goal-conclusion">v <span class="bp">=</span> value</div></blockquote></div></div></small></span><span class="alectryon-wsp"><div class="alectryon-token">
    </div></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk5f" style="display: none" type="checkbox"><label class="alectryon-input" for="khfyyq3b73yaxhnbs5gqly22cvzlmjr0-bintree-lean-chk5f"><div class="alectryon-token"><span class="k">contradiction</span></div></label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion">Goals accomplished<span class="bp">!</span> <span class="bp">ğŸ™</span></div></blockquote></div></div></small></span></pre>
</div>
</div></body>
</html>
